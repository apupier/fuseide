<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Mail Component</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><link rel="home" href="index.html" title="Red Hat Fuse Tooling for Eclipse"><link rel="up" href="IDU-Components.html" title="Part&nbsp;V.&nbsp;Apache Camel Component Reference"><link rel="prev" href="lzf-dataformat.html" title="LZF Deflate Compression DataFormat"><link rel="next" href="metrics-component.html" title="Metrics Component"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="mail-component"></a>Mail Component</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="mail-component.html#_uri_format_120">URI format</a></span></dt><dt><span class="section"><a href="mail-component.html#_anchor_xml_id_mail_component_options_xreflabel_mail_component_options"></a></span></dt><dt><span class="section"><a href="mail-component.html#_anchor_xml_id_mail_endpoint_options_xreflabel_mail_endpoint_options"></a></span></dt><dt><span class="section"><a href="mail-component.html#_components_2">Components</a></span></dt><dt><span class="section"><a href="mail-component.html#_ssl_support_2">SSL support</a></span></dt><dt><span class="section"><a href="mail-component.html#_mail_message_content">Mail Message Content</a></span></dt><dt><span class="section"><a href="mail-component.html#_headers_take_precedence_over_pre_configured_recipients">Headers take precedence over pre-configured recipients</a></span></dt><dt><span class="section"><a href="mail-component.html#_multiple_recipients_for_easier_configuration">Multiple recipients for easier configuration</a></span></dt><dt><span class="section"><a href="mail-component.html#_setting_sender_name_and_email">Setting sender name and email</a></span></dt><dt><span class="section"><a href="mail-component.html#_javamail_api_ex_sun_javamail">JavaMail API (ex SUN JavaMail)</a></span></dt><dt><span class="section"><a href="mail-component.html#_samples_26">Samples</a></span></dt><dt><span class="section"><a href="mail-component.html#_sending_mail_with_attachment_sample">Sending mail with attachment sample</a></span></dt><dt><span class="section"><a href="mail-component.html#_ssl_sample">SSL sample</a></span></dt><dt><span class="section"><a href="mail-component.html#_consuming_mails_with_attachment_sample">Consuming mails with attachment sample</a></span></dt><dt><span class="section"><a href="mail-component.html#_how_to_split_a_mail_message_with_attachments">How to split a mail message with attachments</a></span></dt><dt><span class="section"><a href="mail-component.html#_using_custom_searchterm">Using custom SearchTerm</a></span></dt><dt><span class="section"><a href="mail-component.html#_see_also_76">See Also</a></span></dt></dl></div><p><span class="strong"><strong>Available as of Camel version 1.0</strong></span></p><p>The mail component provides access to Email via Spring&#8217;s Mail support
and the underlying JavaMail system.</p><p>Maven users will need to add the following dependency to their <code class="literal">pom.xml</code>
for this component:</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;dependency&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;groupId&gt;</strong>org.apache.camel<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/groupId&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;artifactId&gt;</strong>camel-mail<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/artifactId&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;version&gt;</strong>x.x.x<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/version&gt;</strong>
    <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- use the same version as your Camel core version --&gt;</em>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/dependency&gt;</strong></pre><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="imagesdb/warning.png"></td><th align="left">Warning</th></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>Geronimo mail .jar</strong></span></p></td></tr></table></div><p>We have discovered that the geronimo mail <code class="literal">.jar</code> (v1.6) has a bug when
polling mails with attachments. It cannot correctly identify the
<code class="literal">Content-Type</code>. So, if you attach a <code class="literal">.jpeg</code> file to a mail and you poll
it, the <code class="literal">Content-Type</code> is resolved as <code class="literal">text/plain</code> and not as
<code class="literal">image/jpeg</code>. For that reason, we have added an
<code class="literal">org.apache.camel.component.ContentTypeResolver</code> SPI interface which
enables you to provide your own implementation and fix this bug by
returning the correct Mime type based on the file name. So if the file
name ends with <code class="literal">jpeg/jpg</code>, you can return <code class="literal">image/jpeg</code>.</p><p>You can set your custom resolver on the <code class="literal">MailComponent</code> instance or on
the <code class="literal">MailEndpoint</code> instance.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="imagesdb/tip.png"></td><th align="left">Tip</th></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>POP3 or IMAP</strong></span>
POP3 has some limitations and end users are encouraged to use IMAP if
possible.</p></td></tr></table></div><p>INFO: <span class="strong"><strong>Using mock-mail for testing</strong></span>
You can use a mock framework for unit testing, which allows you to test
without the need for a real mail server. However you should remember to
not include the mock-mail when you go into production or other
environments where you need to send mails to a real mail server. Just
the presence of the mock-javamail.jar on the classpath means that it
will kick in and avoid sending the mails.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_uri_format_120"></a>URI format</h2></div></div></div><p>Mail endpoints can have one of the following URI formats (for the
protocols, SMTP, POP3, or IMAP, respectively):</p><pre class="programlisting">smtp:<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//[username@]host[:port][?options]</em>
pop3:<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//[username@]host[:port][?options]</em>
imap:<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//[username@]host[:port][?options]</em></pre><p>The mail component also supports secure variants of these protocols
(layered over SSL). You can enable the secure protocols by adding <code class="literal">s</code> to
the scheme:</p><pre class="programlisting">smtps:<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//[username@]host[:port][?options]</em>
pop3s:<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//[username@]host[:port][?options]</em>
imaps:<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//[username@]host[:port][?options]</em></pre><p>You can append query options to the URI in the following format,
<code class="literal">?option=value&amp;option=value&amp;&#8230;&#8203;</code></p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_anchor_xml_id_mail_component_options_xreflabel_mail_component_options"></a><a name="Mail-Component-Options"></a></h2></div></div></div><p>The Mail component supports 4 options which are listed below.</p><div class="informaltable"><table border="1" width="100%"><colgroup><col width="19%" class="col_1"><col width="51%" class="col_2"><col width="10%" class="col_3"><col width="20%" class="col_4"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Description</th><th align="center" valign="top">Default</th><th align="left" valign="top">Type</th></tr></thead><tbody><tr><td align="left" valign="top"><p><span class="strong"><strong>configuration</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Sets the Mail configuration</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>MailConfiguration</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>contentTypeResolver</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Resolver to determine Content-Type for file attachments.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>ContentTypeResolver</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>useGlobalSslContext Parameters</strong></span> (security)</p></td><td align="left" valign="top"><p>Enable usage of global SSL context parameters.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>resolveProperty Placeholders</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Whether the component should resolve property placeholders on itself when starting. Only properties which are of String type can use property placeholders.</p></td><td align="center" valign="top"><p>true</p></td><td align="left" valign="top"><p>boolean</p></td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_anchor_xml_id_mail_endpoint_options_xreflabel_mail_endpoint_options"></a><a name="Mail-Endpoint-Options"></a></h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="mail-component.html#_path_parameters_2_parameters_32">Path Parameters (2 parameters):</a></span></dt><dt><span class="section"><a href="mail-component.html#_query_parameters_62_parameters">Query Parameters (62 parameters):</a></span></dt><dt><span class="section"><a href="mail-component.html#_sample_endpoints">Sample endpoints</a></span></dt></dl></div><p>The Mail endpoint is configured using URI syntax:</p><pre class="screen">imap:host:port</pre><p>with the following path and query parameters:</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_path_parameters_2_parameters_32"></a>Path Parameters (2 parameters):</h3></div></div></div><div class="informaltable"><table border="1" width="100%"><colgroup><col width="19%" class="col_1"><col width="51%" class="col_2"><col width="10%" class="col_3"><col width="20%" class="col_4"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Description</th><th align="center" valign="top">Default</th><th align="left" valign="top">Type</th></tr></thead><tbody><tr><td align="left" valign="top"><p><span class="strong"><strong>host</strong></span></p></td><td align="left" valign="top"><p><span class="strong"><strong>Required</strong></span> The mail server host name</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>port</strong></span></p></td><td align="left" valign="top"><p>The port number of the mail server</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>int</p></td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_query_parameters_62_parameters"></a>Query Parameters (62 parameters):</h3></div></div></div><div class="informaltable"><table border="1" width="100%"><colgroup><col width="19%" class="col_1"><col width="51%" class="col_2"><col width="10%" class="col_3"><col width="20%" class="col_4"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Description</th><th align="center" valign="top">Default</th><th align="left" valign="top">Type</th></tr></thead><tbody><tr><td align="left" valign="top"><p><span class="strong"><strong>bridgeErrorHandler</strong></span> (consumer)</p></td><td align="left" valign="top"><p>Allows for bridging the consumer to the Camel routing Error Handler, which mean any exceptions occurred while the consumer is trying to pickup incoming messages, or the likes, will now be processed as a message and handled by the routing Error Handler. By default the consumer will use the org.apache.camel.spi.ExceptionHandler to deal with exceptions, that will be logged at WARN or ERROR level and ignored.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>closeFolder</strong></span> (consumer)</p></td><td align="left" valign="top"><p>Whether the consumer should close the folder after polling. Setting this option to false and having disconnect=false as well, then the consumer keep the folder open between polls.</p></td><td align="center" valign="top"><p>true</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>copyTo</strong></span> (consumer)</p></td><td align="left" valign="top"><p>After processing a mail message, it can be copied to a mail folder with the given name. You can override this configuration value, with a header with the key copyTo, allowing you to copy messages to folder names configured at runtime.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>delete</strong></span> (consumer)</p></td><td align="left" valign="top"><p>Deletes the messages after they have been processed. This is done by setting the DELETED flag on the mail message. If false, the SEEN flag is set instead. As of Camel 2.10 you can override this configuration option by setting a header with the key delete to determine if the mail should be deleted or not.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>disconnect</strong></span> (consumer)</p></td><td align="left" valign="top"><p>Whether the consumer should disconnect after polling. If enabled this forces Camel to connect on each poll.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>handleFailedMessage</strong></span> (consumer)</p></td><td align="left" valign="top"><p>If the mail consumer cannot retrieve a given mail message, then this option allows to handle the caused exception by the consumer&#8217;s error handler. By enable the bridge error handler on the consumer, then the Camel routing error handler can handle the exception instead. The default behavior would be the consumer throws an exception and no mails from the batch would be able to be routed by Camel.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>maxMessagesPerPoll</strong></span> (consumer)</p></td><td align="left" valign="top"><p>Specifies the maximum number of messages to gather per poll. By default, no maximum is set. Can be used to set a limit of e.g. 1000 to avoid downloading thousands of files when the server starts up. Set a value of 0 or negative to disable this option.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>int</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>mimeDecodeHeaders</strong></span> (consumer)</p></td><td align="left" valign="top"><p>This option enables transparent MIME decoding and unfolding for mail headers.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>peek</strong></span> (consumer)</p></td><td align="left" valign="top"><p>Will mark the javax.mail.Message as peeked before processing the mail message. This applies to IMAPMessage messages types only. By using peek the mail will not be eager marked as SEEN on the mail server, which allows us to rollback the mail message if there is an error processing in Camel.</p></td><td align="center" valign="top"><p>true</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>sendEmptyMessageWhenIdle</strong></span> (consumer)</p></td><td align="left" valign="top"><p>If the polling consumer did not poll any files, you can enable this option to send an empty message (no body) instead.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>skipFailedMessage</strong></span> (consumer)</p></td><td align="left" valign="top"><p>If the mail consumer cannot retrieve a given mail message, then this option allows to skip the message and move on to retrieve the next mail message. The default behavior would be the consumer throws an exception and no mails from the batch would be able to be routed by Camel.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>unseen</strong></span> (consumer)</p></td><td align="left" valign="top"><p>Whether to limit by unseen mails only.</p></td><td align="center" valign="top"><p>true</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>exceptionHandler</strong></span> (consumer)</p></td><td align="left" valign="top"><p>To let the consumer use a custom ExceptionHandler. Notice if the option bridgeErrorHandler is enabled then this options is not in use. By default the consumer will deal with exceptions, that will be logged at WARN or ERROR level and ignored.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>ExceptionHandler</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>exchangePattern</strong></span> (consumer)</p></td><td align="left" valign="top"><p>Sets the exchange pattern when the consumer creates an exchange.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>ExchangePattern</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>fetchSize</strong></span> (consumer)</p></td><td align="left" valign="top"><p>Sets the maximum number of messages to consume during a poll. This can be used to avoid overloading a mail server, if a mailbox folder contains a lot of messages. Default value of -1 means no fetch size and all messages will be consumed. Setting the value to 0 is a special corner case, where Camel will not consume any messages at all.</p></td><td align="center" valign="top"><p>-1</p></td><td align="left" valign="top"><p>int</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>folderName</strong></span> (consumer)</p></td><td align="left" valign="top"><p>The folder to poll.</p></td><td align="center" valign="top"><p>INBOX</p></td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>mailUidGenerator</strong></span> (consumer)</p></td><td align="left" valign="top"><p>A pluggable MailUidGenerator that allows to use custom logic to generate UUID of the mail message.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>MailUidGenerator</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>mapMailMessage</strong></span> (consumer)</p></td><td align="left" valign="top"><p>Specifies whether Camel should map the received mail message to Camel body/headers. If set to true, the body of the mail message is mapped to the body of the Camel IN message and the mail headers are mapped to IN headers. If this option is set to false then the IN message contains a raw javax.mail.Message. You can retrieve this raw message by calling exchange.getIn().getBody(javax.mail.Message.class).</p></td><td align="center" valign="top"><p>true</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>pollStrategy</strong></span> (consumer)</p></td><td align="left" valign="top"><p>A pluggable org.apache.camel.PollingConsumerPollingStrategy allowing you to provide your custom implementation to control error handling usually occurred during the poll operation before an Exchange have been created and being routed in Camel.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>PollingConsumerPoll Strategy</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>postProcessAction</strong></span> (consumer)</p></td><td align="left" valign="top"><p>Refers to an MailBoxPostProcessAction for doing post processing tasks on the mailbox once the normal processing ended.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>MailBoxPostProcess Action</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>bcc</strong></span> (producer)</p></td><td align="left" valign="top"><p>Sets the BCC email address. Separate multiple email addresses with comma.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>cc</strong></span> (producer)</p></td><td align="left" valign="top"><p>Sets the CC email address. Separate multiple email addresses with comma.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>from</strong></span> (producer)</p></td><td align="left" valign="top"><p>The from email address</p></td><td align="center" valign="top"><p>camel@localhost</p></td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>replyTo</strong></span> (producer)</p></td><td align="left" valign="top"><p>The Reply-To recipients (the receivers of the response mail). Separate multiple email addresses with a comma.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>subject</strong></span> (producer)</p></td><td align="left" valign="top"><p>The Subject of the message being sent. Note: Setting the subject in the header takes precedence over this option.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>to</strong></span> (producer)</p></td><td align="left" valign="top"><p>Sets the To email address. Separate multiple email addresses with comma.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>javaMailSender</strong></span> (producer)</p></td><td align="left" valign="top"><p>To use a custom org.apache.camel.component.mail.JavaMailSender for sending emails.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>JavaMailSender</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>additionalJavaMail Properties</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Sets additional java mail properties, that will append/override any default properties that is set based on all the other options. This is useful if you need to add some special options but want to keep the others as is.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>Properties</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>alternativeBodyHeader</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Specifies the key to an IN message header that contains an alternative email body. For example, if you send emails in text/html format and want to provide an alternative mail body for non-HTML email clients, set the alternative mail body with this key as a header.</p></td><td align="center" valign="top"><p>CamelMailAlternativeBody</p></td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>attachmentsContentTransfer EncodingResolver</strong></span> (advanced)</p></td><td align="left" valign="top"><p>To use a custom AttachmentsContentTransferEncodingResolver to resolve what content-type-encoding to use for attachments.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>AttachmentsContent TransferEncoding Resolver</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>binding</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Sets the binding used to convert from a Camel message to and from a Mail message</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>MailBinding</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>connectionTimeout</strong></span> (advanced)</p></td><td align="left" valign="top"><p>The connection timeout in milliseconds.</p></td><td align="center" valign="top"><p>30000</p></td><td align="left" valign="top"><p>int</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>contentType</strong></span> (advanced)</p></td><td align="left" valign="top"><p>The mail message content type. Use text/html for HTML mails.</p></td><td align="center" valign="top"><p>text/plain</p></td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>contentTypeResolver</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Resolver to determine Content-Type for file attachments.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>ContentTypeResolver</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>debugMode</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Enable debug mode on the underlying mail framework. The SUN Mail framework logs the debug messages to System.out by default.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>headerFilterStrategy</strong></span> (advanced)</p></td><td align="left" valign="top"><p>To use a custom org.apache.camel.spi.HeaderFilterStrategy to filter headers.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>HeaderFilterStrategy</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>ignoreUnsupportedCharset</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Option to let Camel ignore unsupported charset in the local JVM when sending mails. If the charset is unsupported then charset=XXX (where XXX represents the unsupported charset) is removed from the content-type and it relies on the platform default instead.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>ignoreUriScheme</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Option to let Camel ignore unsupported charset in the local JVM when sending mails. If the charset is unsupported then charset=XXX (where XXX represents the unsupported charset) is removed from the content-type and it relies on the platform default instead.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>session</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Specifies the mail session that camel should use for all mail interactions. Useful in scenarios where mail sessions are created and managed by some other resource, such as a JavaEE container. If this is not specified, Camel automatically creates the mail session for you.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>Session</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>synchronous</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Sets whether synchronous processing should be strictly used, or Camel is allowed to use asynchronous processing (if supported).</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>useInlineAttachments</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Whether to use disposition inline or attachment.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>idempotentRepository</strong></span> (filter)</p></td><td align="left" valign="top"><p>A pluggable repository org.apache.camel.spi.IdempotentRepository which allows to cluster consuming from the same mailbox, and let the repository coordinate whether a mail message is valid for the consumer to process. By default no repository is in use.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String&gt;</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>idempotentRepositoryRemove OnCommit</strong></span> (filter)</p></td><td align="left" valign="top"><p>When using idempotent repository, then when the mail message has been successfully processed and is committed, should the message id be removed from the idempotent repository (default) or be kept in the repository. By default its assumed the message id is unique and has no value to be kept in the repository, because the mail message will be marked as seen/moved or deleted to prevent it from being consumed again. And therefore having the message id stored in the idempotent repository has little value. However this option allows to store the message id, for whatever reason you may have.</p></td><td align="center" valign="top"><p>true</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>searchTerm</strong></span> (filter)</p></td><td align="left" valign="top"><p>Refers to a javax.mail.search.SearchTerm which allows to filter mails based on search criteria such as subject, body, from, sent after a certain date etc.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>SearchTerm</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>backoffErrorThreshold</strong></span> (scheduler)</p></td><td align="left" valign="top"><p>The number of subsequent error polls (failed due some error) that should happen before the backoffMultipler should kick-in.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>int</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>backoffIdleThreshold</strong></span> (scheduler)</p></td><td align="left" valign="top"><p>The number of subsequent idle polls that should happen before the backoffMultipler should kick-in.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>int</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>backoffMultiplier</strong></span> (scheduler)</p></td><td align="left" valign="top"><p>To let the scheduled polling consumer backoff if there has been a number of subsequent idles/errors in a row. The multiplier is then the number of polls that will be skipped before the next actual attempt is happening again. When this option is in use then backoffIdleThreshold and/or backoffErrorThreshold must also be configured.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>int</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>delay</strong></span> (scheduler)</p></td><td align="left" valign="top"><p>Milliseconds before the next poll.</p></td><td align="center" valign="top"><p>60000</p></td><td align="left" valign="top"><p>long</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>greedy</strong></span> (scheduler)</p></td><td align="left" valign="top"><p>If greedy is enabled, then the ScheduledPollConsumer will run immediately again, if the previous run polled 1 or more messages.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>initialDelay</strong></span> (scheduler)</p></td><td align="left" valign="top"><p>Milliseconds before the first poll starts. You can also specify time values using units, such as 60s (60 seconds), 5m30s (5 minutes and 30 seconds), and 1h (1 hour).</p></td><td align="center" valign="top"><p>1000</p></td><td align="left" valign="top"><p>long</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>runLoggingLevel</strong></span> (scheduler)</p></td><td align="left" valign="top"><p>The consumer logs a start/complete log line when it polls. This option allows you to configure the logging level for that.</p></td><td align="center" valign="top"><p>TRACE</p></td><td align="left" valign="top"><p>LoggingLevel</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>scheduledExecutorService</strong></span> (scheduler)</p></td><td align="left" valign="top"><p>Allows for configuring a custom/shared thread pool to use for the consumer. By default each consumer has its own single threaded thread pool.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>ScheduledExecutor Service</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>scheduler</strong></span> (scheduler)</p></td><td align="left" valign="top"><p>To use a cron scheduler from either camel-spring or camel-quartz2 component</p></td><td align="center" valign="top"><p>none</p></td><td align="left" valign="top"><p>ScheduledPollConsumer Scheduler</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>schedulerProperties</strong></span> (scheduler)</p></td><td align="left" valign="top"><p>To configure additional properties when using a custom scheduler or any of the Quartz2, Spring based scheduler.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>Map</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>startScheduler</strong></span> (scheduler)</p></td><td align="left" valign="top"><p>Whether the scheduler should be auto started.</p></td><td align="center" valign="top"><p>true</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>timeUnit</strong></span> (scheduler)</p></td><td align="left" valign="top"><p>Time unit for initialDelay and delay options.</p></td><td align="center" valign="top"><p>MILLISECONDS</p></td><td align="left" valign="top"><p>TimeUnit</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>useFixedDelay</strong></span> (scheduler)</p></td><td align="left" valign="top"><p>Controls if fixed delay or fixed rate is used. See ScheduledExecutorService in JDK for details.</p></td><td align="center" valign="top"><p>true</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>sortTerm</strong></span> (sort)</p></td><td align="left" valign="top"><p>Sorting order for messages. Only natively supported for IMAP. Emulated to some degree when using POP3 or when IMAP server does not have the SORT capability.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>dummyTrustManager</strong></span> (security)</p></td><td align="left" valign="top"><p>To use a dummy security setting for trusting all certificates. Should only be used for development mode, and not production.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>password</strong></span> (security)</p></td><td align="left" valign="top"><p>The password for login</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>sslContextParameters</strong></span> (security)</p></td><td align="left" valign="top"><p>To configure security using SSLContextParameters.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>SSLContextParameters</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>username</strong></span> (security)</p></td><td align="left" valign="top"><p>The username for login</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_sample_endpoints"></a>Sample endpoints</h3></div></div></div><p>Typically, you specify a URI with login credentials as follows (taking
SMTP as an example):</p><pre class="programlisting">smtp:<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//[username@]host[:port][?password=somepwd]</em></pre><p>Alternatively, it is possible to specify both the user name and the
password as query options:</p><pre class="programlisting">smtp:<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//host[:port]?password=somepwd&amp;username=someuser</em></pre><p>For example:</p><pre class="programlisting">smtp:<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//mycompany.mailserver:30?password=tiger&amp;username=scott</em></pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_components_2"></a>Components</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="mail-component.html#_default_ports">Default ports</a></span></dt></dl></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">IMAP</li><li class="listitem">IMAPs</li><li class="listitem">POP3s</li><li class="listitem">POP3s</li><li class="listitem">SMTP</li><li class="listitem">SMTPs</li></ul></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_default_ports"></a>Default ports</h3></div></div></div><p>Default port numbers are supported. If the port number is omitted, Camel
determines the port number to use based on the protocol.</p><div class="informaltable"><table border="1" width="100%"><colgroup><col width="10%" class="col_1"><col width="90%" class="col_2"></colgroup><thead><tr><th align="left" valign="top">Protocol</th><th align="left" valign="top">Default Port Number</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">SMTP</code></p></td><td align="left" valign="top"><p><code class="literal">25</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">SMTPS</code></p></td><td align="left" valign="top"><p><code class="literal">465</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">POP3</code></p></td><td align="left" valign="top"><p><code class="literal">110</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">POP3S</code></p></td><td align="left" valign="top"><p><code class="literal">995</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">IMAP</code></p></td><td align="left" valign="top"><p><code class="literal">143</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">IMAPS</code></p></td><td align="left" valign="top"><p><code class="literal">993</code></p></td></tr></tbody></table></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_ssl_support_2"></a>SSL support</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="mail-component.html#_using_the_jsse_configuration_utility_3">Using the JSSE Configuration Utility</a></span></dt><dt><span class="section"><a href="mail-component.html#_configuring_javamail_directly">Configuring JavaMail Directly</a></span></dt></dl></div><p>The underlying mail framework is responsible for providing SSL support.
&nbsp;You may either configure SSL/TLS support by completely specifying the
necessary Java Mail API configuration options, or you may provide a
configured SSLContextParameters through the component or endpoint
configuration.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_using_the_jsse_configuration_utility_3"></a>Using the JSSE Configuration Utility</h3></div></div></div><p>As of <span class="strong"><strong>Camel 2.10</strong></span>, the mail component supports SSL/TLS configuration
through the <a class="link" href="camel-configuration-utilities.html" target="_top">Camel JSSE
Configuration Utility</a>.&nbsp; This utility greatly decreases the amount of
component specific code you need to write and is configurable at the
endpoint and component levels.&nbsp; The following examples demonstrate how
to use the utility with the mail component.</p><p><a name="Mail-Programmaticconfigurationoftheendpoint"></a>Programmatic configuration of the endpoint</p><pre class="programlisting">KeyStoreParameters ksp = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> KeyStoreParameters();
ksp.setResource(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"/users/home/server/truststore.jks"</em></strong>);
ksp.setPassword(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"keystorePassword"</em></strong>);
TrustManagersParameters tmp = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> TrustManagersParameters();
tmp.setKeyStore(ksp);
SSLContextParameters scp = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> SSLContextParameters();
scp.setTrustManagers(tmp);
Registry registry = ...
registry.bind(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"sslContextParameters"</em></strong>, scp);
...
from(...)
&amp;nbsp; &amp;nbsp; .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"smtps://smtp.google.com?username=user@gmail.com&amp;password=password&amp;sslContextParameters=#sslContextParameters"</em></strong>);</pre><p><a name="Mail-SpringDSLbasedconfigurationofendpoint"></a>Spring DSL based configuration of endpoint</p><pre class="programlisting">...
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;camel:sslContextParameters</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"sslContextParameters"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;camel:trustManagers&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;camel:keyStore</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">resource</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"/users/home/server/truststore.jks"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">password</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"keystorePassword"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/camel:trustManagers&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/camel:sslContextParameters&gt;</strong>...
...
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"smtps://smtp.google.com?username=user@gmail.com&amp;password=password&amp;sslContextParameters=#sslContextParameters"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>...</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_configuring_javamail_directly"></a>Configuring JavaMail Directly</h3></div></div></div><p>Camel uses SUN JavaMail, which only trusts certificates issued by well
known Certificate Authorities (the default JVM trust configuration). If
you issue your own certificates, you have to import the CA certificates
into the JVM&#8217;s Java trust/key store files, override the default JVM
trust/key store files (see <code class="literal">SSLNOTES.txt</code> in JavaMail for details).</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_mail_message_content"></a>Mail Message Content</h2></div></div></div><p>Camel uses the message exchange&#8217;s IN body as the
<a class="link" href="http://java.sun.com/javaee/5/docs/api/javax/mail/internet/MimeMessage.html" target="_top">MimeMessage</a>
text content. The body is converted to <code class="literal">String.class</code>.</p><p>Camel copies all of the exchange&#8217;s IN headers to the
<a class="link" href="http://java.sun.com/javaee/5/docs/api/javax/mail/internet/MimeMessage.html" target="_top">MimeMessage</a>
headers.</p><p>The subject of the
<a class="link" href="http://java.sun.com/javaee/5/docs/api/javax/mail/internet/MimeMessage.html" target="_top">MimeMessage</a>
can be configured using a header property on the IN message. The code
below demonstrates this:</p><p>The same applies for other MimeMessage headers such as recipients, so
you can use a header property as <code class="literal">To</code>:</p><p><span class="strong"><strong>Since Camel 2.11</strong></span> When using the MailProducer the send the mail to
server, you should be able to get the message id of the
<a class="link" href="http://java.sun.com/javaee/5/docs/api/javax/mail/internet/MimeMessage.html" target="_top">MimeMessage</a>
with the key <code class="literal">CamelMailMessageId</code> from the Camel message header.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_headers_take_precedence_over_pre_configured_recipients"></a>Headers take precedence over pre-configured recipients</h2></div></div></div><p>The recipients specified in the message headers always take precedence
over recipients pre-configured in the endpoint URI. The idea is that if
you provide any recipients in the message headers, that is what you get.
The recipients pre-configured in the endpoint URI are treated as a
fallback.</p><p>In the sample code below, the email message is sent to
<code class="literal">davsclaus@apache.org</code>, because it takes precedence over the
pre-configured recipient, <code class="literal">info@mycompany.com</code>. Any <code class="literal">CC</code> and <code class="literal">BCC</code>
settings in the endpoint URI are also ignored and those recipients will
not receive any mail. The choice between headers and pre-configured
settings is all or nothing: the mail component <span class="emphasis"><em>either</em></span> takes the
recipients exclusively from the headers or exclusively from the
pre-configured settings. It is not possible to mix and match headers and
pre-configured settings.</p><pre class="programlisting">        Map&lt;String, Object&gt; headers = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> HashMap&lt;String, Object&gt;();
        headers.put(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"to"</em></strong>, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"davsclaus@apache.org"</em></strong>);

        template.sendBodyAndHeaders(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"smtp://admin@localhost?to=info@mycompany.com"</em></strong>, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"Hello World"</em></strong>, headers);</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_multiple_recipients_for_easier_configuration"></a>Multiple recipients for easier configuration</h2></div></div></div><p>It is possible to set multiple recipients using a comma-separated or a
semicolon-separated list. This applies both to header settings and to
settings in an endpoint URI. For example:</p><pre class="programlisting">        Map&lt;String, Object&gt; headers = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> HashMap&lt;String, Object&gt;();
        headers.put(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"to"</em></strong>, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"davsclaus@apache.org ; jstrachan@apache.org ; ningjiang@apache.org"</em></strong>);</pre><p>The preceding example uses a semicolon, <code class="literal">;</code>, as the separator character.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_setting_sender_name_and_email"></a>Setting sender name and email</h2></div></div></div><p>You can specify recipients in the format, <code class="literal">name &lt;email&gt;</code>, to include
both the name and the email address of the recipient.</p><p>For example, you define the following headers on the a
Message:</p><pre class="programlisting">Map headers = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> HashMap();
map.put(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"To"</em></strong>, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"Claus Ibsen &lt;davsclaus@apache.org&gt;"</em></strong>);
map.put(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"From"</em></strong>, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"James Strachan &lt;jstrachan@apache.org&gt;"</em></strong>);
map.put(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"Subject"</em></strong>, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"Camel is cool"</em></strong>);</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_javamail_api_ex_sun_javamail"></a>JavaMail API (ex SUN JavaMail)</h2></div></div></div><p><a class="link" href="https://java.net/projects/javamail/pages/Home" target="_top">JavaMail API</a> is used
under the hood for consuming and producing mails.
 We encourage end-users to consult these references when using either
POP3 or IMAP protocol. Note particularly that POP3 has a much more
limited set of features than IMAP.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a class="link" href="https://javamail.java.net/nonav/docs/api/com/sun/mail/pop3/package-summary.html" target="_top">JavaMail
POP3 API</a></li><li class="listitem"><a class="link" href="https://javamail.java.net/nonav/docs/api/com/sun/mail/imap/package-summary.html" target="_top">JavaMail
IMAP API</a></li><li class="listitem">And generally about the
<a class="link" href="https://javamail.java.net/nonav/docs/api/javax/mail/Flags.html" target="_top">MAIL
Flags</a></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_samples_26"></a>Samples</h2></div></div></div><p>We start with a simple route that sends the messages received from a JMS
queue as emails. The email account is the <code class="literal">admin</code> account on
<code class="literal">mymailserver.com</code>.</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"jms://queue:subscription"</em></strong>).to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"smtp://admin@mymailserver.com?password=secret"</em></strong>);</pre><p>In the next sample, we poll a mailbox for new emails once every minute.
Notice that we use the special <code class="literal">consumer</code> option for setting the poll
interval, <code class="literal">consumer.delay</code>, as 60000 milliseconds = 60 seconds.</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"imap://admin@mymailserver.com
</em></strong>     password=secret&amp;unseen=true&amp;consumer.delay=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">60000</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">")
</em></strong>    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"seda://mails"</em></strong>);</pre><p>In this sample we want to send a mail to multiple recipients:</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_sending_mail_with_attachment_sample"></a>Sending mail with attachment sample</h2></div></div></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="imagesdb/warning.png"></td><th align="left">Warning</th></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>Attachments are not support by all Camel components</strong></span>
The <span class="emphasis"><em>Attachments API</em></span> is based on the Java Activation Framework and is
generally only used by the Mail API. Since many of the other Camel
components do not support attachments, the attachments could potentially
be lost as they propagate along the route. The rule of thumb, therefore,
is to add attachments just before sending a message to the mail
endpoint.</p></td></tr></table></div><p>The mail component supports attachments. In the sample below, we send a
mail message containing a plain text message with a logo file
attachment.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_ssl_sample"></a>SSL sample</h2></div></div></div><p>In this sample, we want to poll our Google mail inbox for mails. To
download mail onto a local mail client, Google mail requires you to
enable and configure SSL. This is done by logging into your Google mail
account and changing your settings to allow IMAP access. Google have
extensive documentation on how to do this.</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"imaps://imap.gmail.com?username=YOUR_USERNAME@gmail.com&amp;password=YOUR_PASSWORD"</em></strong>
    + <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"&amp;delete=false&amp;unseen=true&amp;consumer.delay=60000"</em></strong>).to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"log:newmail"</em></strong>);</pre><p>The preceding route polls the Google mail inbox for new mails once every
minute and logs the received messages to the <code class="literal">newmail</code> logger
category.
 Running the sample with <code class="literal">DEBUG</code> logging enabled, we can monitor the
progress in the logs:</p><pre class="programlisting"><span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">2008</span>-<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">05</span>-<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">08</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">06</span>:<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">32</span>:<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">09</span>,<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">640</span> DEBUG MailConsumer - Connecting to MailStore imaps<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//imap.gmail.com:993 (SSL enabled), folder=INBOX</em>
<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">2008</span>-<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">05</span>-<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">08</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">06</span>:<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">32</span>:<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">11</span>,<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">203</span> DEBUG MailConsumer - Polling mailfolder: imaps<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//imap.gmail.com:993 (SSL enabled), folder=INBOX</em>
<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">2008</span>-<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">05</span>-<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">08</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">06</span>:<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">32</span>:<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">11</span>,<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">640</span> DEBUG MailConsumer - Fetching <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">1</span> messages. Total <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">1</span> messages.
<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">2008</span>-<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">05</span>-<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">08</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">06</span>:<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">32</span>:<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">12</span>,<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">171</span> DEBUG MailConsumer - Processing message: messageNumber=[<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">332</span>], from=[James Bond &lt;<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">007</span><em xmlns="http://www.w3.org/1999/xhtml"><span class="hl-annotation" style="color: gray">@mi5.co.uk&gt;],</span></em> to=YOUR_USERNAME<em xmlns="http://www.w3.org/1999/xhtml"><span class="hl-annotation" style="color: gray">@gmail.com],</span></em> subject=[...
<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">2008</span>-<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">05</span>-<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">08</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">06</span>:<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">32</span>:<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">12</span>,<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">187</span> INFO  newmail - Exchange[MailMessage: messageNumber=[<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">332</span>], from=[James Bond &lt;<span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">007</span><em xmlns="http://www.w3.org/1999/xhtml"><span class="hl-annotation" style="color: gray">@mi5.co.uk&gt;],</span></em> to=YOUR_USERNAME<em xmlns="http://www.w3.org/1999/xhtml"><span class="hl-annotation" style="color: gray">@gmail.com],</span></em> subject=[...</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_consuming_mails_with_attachment_sample"></a>Consuming mails with attachment sample</h2></div></div></div><p>In this sample we poll a mailbox and store all attachments from the
mails as files. First, we define a route to poll the mailbox. As this
sample is based on google mail, it uses the same route as shown in the
SSL sample:</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"imaps://imap.gmail.com?username=YOUR_USERNAME@gmail.com&amp;password=YOUR_PASSWORD"</em></strong>
    + <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"&amp;delete=false&amp;unseen=true&amp;consumer.delay=60000"</em></strong>).process(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> MyMailProcessor());</pre><p>Instead of logging the mail we use a processor where we can process the
mail from java code:</p><pre class="programlisting">    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">public</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">void</strong> process(Exchange exchange) <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">throws</strong> Exception {
        <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// the API is a bit clunky so we need to loop</em>
        Map&lt;String, DataHandler&gt; attachments = exchange.getIn().getAttachments();
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">if</strong> (attachments.size() &gt; <span xmlns="http://www.w3.org/1999/xhtml" class="hl-number">0</span>) {
            <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">for</strong> (String name : attachments.keySet()) {
                DataHandler dh = attachments.get(name);
                <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// get the file name</em>
                String filename = dh.getName();

                <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// get the content and convert it to byte[]</em>
                <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">byte</strong>[] data = exchange.getContext().getTypeConverter()
                                  .convertTo(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">byte</strong>[].<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">class</strong>, dh.getInputStream());

                <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// write the data to a file</em>
                FileOutputStream out = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> FileOutputStream(filename);
                out.write(data);
                out.flush();
                out.close();
            }
        }
   }</pre><p>As you can see the API to handle attachments is a bit clunky but it&#8217;s
there so you can get the <code class="literal">javax.activation.DataHandler</code> so you can
handle the attachments using standard API.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_how_to_split_a_mail_message_with_attachments"></a>How to split a mail message with attachments</h2></div></div></div><p>In this example we consume mail messages which may have a number of
attachments. What we want to do is to use the
Splitter EIP per individual attachment, to process
the attachments separately. For example if the mail message has 5
attachments, we want the Splitter to process five
messages, each having a single attachment. To do this we need to provide
a custom Expression to the
Splitter where we provide a List&lt;Message&gt; that
contains the five messages with the single attachment.</p><p>The code is provided out of the box in Camel 2.10 onwards in the
<code class="literal">camel-mail</code> component. The code is in the class:
<code class="literal">org.apache.camel.component.mail.SplitAttachmentsExpression</code>, which you
can find the source code
<a class="link" href="https://svn.apache.org/repos/asf/camel/trunk/components/camel-mail/src/main/java/org/apache/camel/component/mail/SplitAttachmentsExpression.java" target="_top">here</a></p><p>In the Camel route you then need to use this
Expression in the route as shown below:</p><p>If you use XML DSL then you need to declare a method call expression in
the Splitter as shown below</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;split&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;method</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">beanType</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"org.apache.camel.component.mail.SplitAttachmentsExpression"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"mock:split"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/split&gt;</strong></pre><p>&nbsp;</p><p>From Camel 2.16 onwards you can also split the attachments as byte[] to
be stored as the message body. This is done by creating the expression
with boolean true</p><pre class="programlisting">SplitAttachmentsExpression split = SplitAttachmentsExpression(true);</pre><p>And then use the expression with the splitter eip.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_using_custom_searchterm"></a>Using custom SearchTerm</h2></div></div></div><p><span class="strong"><strong>Available as of Camel 2.11</strong></span></p><p>You can configure a <code class="literal">searchTerm</code> on the <code class="literal">MailEndpoint</code> which allows you
to filter out unwanted mails.</p><p>For example to filter mails to contain Camel in either Subject or Text
you can do as follows:</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;route&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;from</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"imaps://mymailseerver?username=foo&amp;password=secret&amp;searchTerm.subjectOrBody=Camel"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"bean:myBean"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/route&gt;</strong></pre><p>Notice we use the <code class="literal">"searchTerm.subjectOrBody"</code> as parameter key to
indicate that we want to search on mail subject or body, to contain the
word "Camel".
 The class <code class="literal">org.apache.camel.component.mail.SimpleSearchTerm</code> has a
number of options you can configure:</p><p>Or to get the new unseen emails going 24 hours back in time you can do.
Notice the "now-24h" syntax. See the table below for more details.</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;route&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;from</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"imaps://mymailseerver?username=foo&amp;password=secret&amp;searchTerm.fromSentDate=now-24h"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"bean:myBean"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/route&gt;</strong></pre><p>You can have multiple searchTerm in the endpoint uri configuration. They
would then be combined together using AND operator, eg so both
conditions must match. For example to get the last unseen emails going
back 24 hours which has Camel in the mail subject you can do:</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;route&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;from</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"imaps://mymailseerver?username=foo&amp;password=secret&amp;searchTerm.subject=Camel&amp;searchTerm.fromSentDate=now-24h"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"bean:myBean"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/route&gt;</strong></pre><p>The <code class="literal">SimpleSearchTerm</code> is designed to be easily configurable from a
POJO, so you can also configure it using a &lt;bean&gt; style in XML</p><pre class="programlisting">&lt;bean id=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mySearchTerm"</em></strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">class</strong>=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"org.apache.camel.component.mail.SimpleSearchTerm"</em></strong>&gt;
  &lt;property name=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"subject"</em></strong> value=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"Order"</em></strong>/&gt;
  &lt;property name=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"to"</em></strong> value=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"acme-order@acme.com"</em></strong>/&gt;
  &lt;property name=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"fromSentDate"</em></strong> value=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"now"</em></strong>/&gt;
 &lt;/bean&gt;</pre><p>You can then refer to this bean, using #beanId in your Camel route as
shown:</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;route&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;from</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"imaps://mymailseerver?username=foo&amp;password=secret&amp;searchTerm=#mySearchTerm"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"bean:myBean"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/route&gt;</strong></pre><p>In Java there is a builder class to build compound
<code class="literal">SearchTerms</code> using the <code class="literal">org.apache.camel.component.mail.SearchTermBuilder</code>
class. This allows you to build complex terms such as:</p><pre class="programlisting"><em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// we just want the unseen mails which is not spam</em>
SearchTermBuilder builder = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> SearchTermBuilder();

builder.unseen().body(Op.not, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"Spam"</em></strong>).subject(Op.not, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"Spam"</em></strong>)
  <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// which was sent from either foo or bar</em>
  .from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"foo@somewhere.com"</em></strong>).from(Op.or, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"bar@somewhere.com"</em></strong>);
  <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// .. and we could continue building the terms</em>

SearchTerm term = builder.build();</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_see_also_76"></a>See Also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Configuring Camel</li><li class="listitem">Component</li><li class="listitem">Endpoint</li><li class="listitem">Getting Started</li></ul></div></div></div></body></html>