<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>SIP Component</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><link rel="home" href="index.html" title="Red Hat Fuse Tooling for Eclipse"><link rel="up" href="IDU-Components.html" title="Part&nbsp;V.&nbsp;Apache Camel Component Reference"><link rel="prev" href="simple-language.html" title="Simple Language"><link rel="next" href="sjms-batch-component.html" title="Simple JMS Batch Component"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="sip-component"></a>SIP Component</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="sip-component.html#_uri_format_171">URI format</a></span></dt><dt><span class="section"><a href="sip-component.html#_options_132">Options</a></span></dt><dt><span class="section"><a href="sip-component.html#_sending_messages_to_from_a_sip_endpoint">Sending Messages to/from a SIP endpoint</a></span></dt></dl></div><p><span class="strong"><strong>Available as of Camel version 2.5</strong></span></p><p>The <span class="strong"><strong>sip</strong></span> component in Camel is a communication component, based on the
Jain SIP implementation (available under the JCP license).</p><p>Session Initiation Protocol (SIP) is an IETF-defined signaling protocol,
widely used for controlling multimedia communication sessions such as
voice and video calls over Internet Protocol (IP).The SIP protocol is an
Application Layer protocol designed to be independent of the underlying
transport layer; it can run on Transmission Control Protocol (TCP), User
Datagram Protocol (UDP) or Stream Control Transmission Protocol (SCTP).</p><p>The Jain SIP implementation supports TCP and UDP only.</p><p>The Camel SIP component <span class="strong"><strong>only</strong></span> supports the SIP Publish and Subscribe
capability as described in the
<a class="link" href="http://www.ietf.org/rfc/rfc3903.txt" target="_top">RFC3903 - Session Initiation
Protocol (SIP) Extension for Event</a></p><p>This camel component supports both producer and consumer endpoints.</p><p>Camel SIP Producers (Event Publishers) and SIP Consumers (Event
Subscribers) communicate event &amp; state information to each other using
an intermediary entity called a SIP Presence Agent (a stateful brokering
entity).</p><p>For SIP based communication, a SIP Stack with a listener <span class="strong"><strong>must</strong></span> be
instantiated on both the SIP Producer and Consumer (using separate ports
if using localhost). This is necessary in order to support the
handshakes &amp; acknowledgements exchanged between the SIP Stacks during
communication.</p><p>Maven users will need to add the following dependency to their <code class="literal">pom.xml</code>
for this component:</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;dependency&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;groupId&gt;</strong>org.apache.camel<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/groupId&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;artifactId&gt;</strong>camel-sip<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/artifactId&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;version&gt;</strong>x.x.x<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/version&gt;</strong>
    <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- use the same version as your Camel core version --&gt;</em>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/dependency&gt;</strong></pre><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_uri_format_171"></a>URI format</h2></div></div></div><p>The URI scheme for a sip endpoint is as follows:</p><pre class="programlisting">sip:<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//johndoe@localhost:99999[?options]</em>
sips:<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//johndoe@localhost:99999/[?options]</em></pre><p>This component supports producer and consumer endpoints for both TCP and
UDP.</p><p>You can append query options to the URI in the following format,
<code class="literal">?option=value&amp;option=value&amp;&#8230;&#8203;</code></p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_options_132"></a>Options</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="sip-component.html#_path_parameters_1_parameters_155">Path Parameters (1 parameters):</a></span></dt><dt><span class="section"><a href="sip-component.html#_query_parameters_44_parameters_3">Query Parameters (44 parameters):</a></span></dt></dl></div><p>The SIP Component offers an extensive set of configuration options &amp;
capability to create custom stateful headers needed to propagate state
via the SIP protocol.</p><p>The SIP component has no options.</p><p>The SIP endpoint is configured using URI syntax:</p><pre class="screen">sip:uri</pre><p>with the following path and query parameters:</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_path_parameters_1_parameters_155"></a>Path Parameters (1 parameters):</h3></div></div></div><div class="informaltable"><table border="1" width="100%"><colgroup><col width="19%" class="col_1"><col width="51%" class="col_2"><col width="10%" class="col_3"><col width="20%" class="col_4"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Description</th><th align="center" valign="top">Default</th><th align="left" valign="top">Type</th></tr></thead><tbody><tr><td align="left" valign="top"><p><span class="strong"><strong>uri</strong></span></p></td><td align="left" valign="top"><p><span class="strong"><strong>Required</strong></span> URI of the SIP server to connect to (the username and password can be included such as: john:secretmyserver:9999)</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>URI</p></td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_query_parameters_44_parameters_3"></a>Query Parameters (44 parameters):</h3></div></div></div><div class="informaltable"><table border="1" width="100%"><colgroup><col width="19%" class="col_1"><col width="51%" class="col_2"><col width="10%" class="col_3"><col width="20%" class="col_4"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Description</th><th align="center" valign="top">Default</th><th align="left" valign="top">Type</th></tr></thead><tbody><tr><td align="left" valign="top"><p><span class="strong"><strong>cacheConnections</strong></span> (common)</p></td><td align="left" valign="top"><p>Should connections be cached by the SipStack to reduce cost of connection creation. This is useful if the connection is used for long running conversations.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>contentSubType</strong></span> (common)</p></td><td align="left" valign="top"><p>Setting for contentSubType can be set to any valid MimeSubType.</p></td><td align="center" valign="top"><p>plain</p></td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>contentType</strong></span> (common)</p></td><td align="left" valign="top"><p>Setting for contentType can be set to any valid MimeType.</p></td><td align="center" valign="top"><p>text</p></td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>eventHeaderName</strong></span> (common)</p></td><td align="left" valign="top"><p>Setting for a String based event type.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>eventId</strong></span> (common)</p></td><td align="left" valign="top"><p>Setting for a String based event Id. Mandatory setting unless a registry based FromHeader is specified</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>fromHost</strong></span> (common)</p></td><td align="left" valign="top"><p>Hostname of the message originator. Mandatory setting unless a registry based FromHeader is specified</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>fromPort</strong></span> (common)</p></td><td align="left" valign="top"><p>Port of the message originator. Mandatory setting unless a registry based FromHeader is specified</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>int</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>fromUser</strong></span> (common)</p></td><td align="left" valign="top"><p>Username of the message originator. Mandatory setting unless a registry based custom FromHeader is specified.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>msgExpiration</strong></span> (common)</p></td><td align="left" valign="top"><p>The amount of time a message received at an endpoint is considered valid</p></td><td align="center" valign="top"><p>3600</p></td><td align="left" valign="top"><p>int</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>receiveTimeoutMillis</strong></span> (common)</p></td><td align="left" valign="top"><p>Setting for specifying amount of time to wait for a Response and/or Acknowledgement can be received from another SIP stack</p></td><td align="center" valign="top"><p>10000</p></td><td align="left" valign="top"><p>long</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>stackName</strong></span> (common)</p></td><td align="left" valign="top"><p>Name of the SIP Stack instance associated with an SIP Endpoint.</p></td><td align="center" valign="top"><p>NAME_NOT_SET</p></td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>toHost</strong></span> (common)</p></td><td align="left" valign="top"><p>Hostname of the message receiver. Mandatory setting unless a registry based ToHeader is specified</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>toPort</strong></span> (common)</p></td><td align="left" valign="top"><p>Portname of the message receiver. Mandatory setting unless a registry based ToHeader is specified</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>int</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>toUser</strong></span> (common)</p></td><td align="left" valign="top"><p>Username of the message receiver. Mandatory setting unless a registry based custom ToHeader is specified.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>transport</strong></span> (common)</p></td><td align="left" valign="top"><p>Setting for choice of transport protocol. Valid choices are tcp or udp.</p></td><td align="center" valign="top"><p>tcp</p></td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>bridgeErrorHandler</strong></span> (consumer)</p></td><td align="left" valign="top"><p>Allows for bridging the consumer to the Camel routing Error Handler, which mean any exceptions occurred while the consumer is trying to pickup incoming messages, or the likes, will now be processed as a message and handled by the routing Error Handler. By default the consumer will use the org.apache.camel.spi.ExceptionHandler to deal with exceptions, that will be logged at WARN or ERROR level and ignored.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>consumer</strong></span> (consumer)</p></td><td align="left" valign="top"><p>This setting is used to determine whether the kind of header (FromHeader,ToHeader etc) that needs to be created for this endpoint</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>presenceAgent</strong></span> (consumer)</p></td><td align="left" valign="top"><p>This setting is used to distinguish between a Presence Agent &amp; a consumer. This is due to the fact that the SIP Camel component ships with a basic Presence Agent (for testing purposes only). Consumers have to set this flag to true.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>exceptionHandler</strong></span> (consumer)</p></td><td align="left" valign="top"><p>To let the consumer use a custom ExceptionHandler. Notice if the option bridgeErrorHandler is enabled then this options is not in use. By default the consumer will deal with exceptions, that will be logged at WARN or ERROR level and ignored.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>ExceptionHandler</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>exchangePattern</strong></span> (consumer)</p></td><td align="left" valign="top"><p>Sets the exchange pattern when the consumer creates an exchange.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>ExchangePattern</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>addressFactory</strong></span> (advanced)</p></td><td align="left" valign="top"><p>To use a custom AddressFactory</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>AddressFactory</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>callIdHeader</strong></span> (advanced)</p></td><td align="left" valign="top"><p>A custom Header object containing call details. Must implement the type javax.sip.header.CallIdHeader</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>CallIdHeader</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>contactHeader</strong></span> (advanced)</p></td><td align="left" valign="top"><p>An optional custom Header object containing verbose contact details (email, phone number etc). Must implement the type javax.sip.header.ContactHeader</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>ContactHeader</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>contentTypeHeader</strong></span> (advanced)</p></td><td align="left" valign="top"><p>A custom Header object containing message content details. Must implement the type javax.sip.header.ContentTypeHeader</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>ContentTypeHeader</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>eventHeader</strong></span> (advanced)</p></td><td align="left" valign="top"><p>A custom Header object containing event details. Must implement the type javax.sip.header.EventHeader</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>EventHeader</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>expiresHeader</strong></span> (advanced)</p></td><td align="left" valign="top"><p>A custom Header object containing message expiration details. Must implement the type javax.sip.header.ExpiresHeader</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>ExpiresHeader</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>extensionHeader</strong></span> (advanced)</p></td><td align="left" valign="top"><p>A custom Header object containing user/application specific details. Must implement the type javax.sip.header.ExtensionHeader</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>ExtensionHeader</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>fromHeader</strong></span> (advanced)</p></td><td align="left" valign="top"><p>A custom Header object containing message originator settings. Must implement the type javax.sip.header.FromHeader</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>FromHeader</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>headerFactory</strong></span> (advanced)</p></td><td align="left" valign="top"><p>To use a custom HeaderFactory</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>HeaderFactory</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>listeningPoint</strong></span> (advanced)</p></td><td align="left" valign="top"><p>To use a custom ListeningPoint implementation</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>ListeningPoint</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>maxForwardsHeader</strong></span> (advanced)</p></td><td align="left" valign="top"><p>A custom Header object containing details on maximum proxy forwards. This header places a limit on the viaHeaders possible. Must implement the type javax.sip.header.MaxForwardsHeader</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>MaxForwardsHeader</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>maxMessageSize</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Setting for maximum allowed Message size in bytes.</p></td><td align="center" valign="top"><p>1048576</p></td><td align="left" valign="top"><p>int</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>messageFactory</strong></span> (advanced)</p></td><td align="left" valign="top"><p>To use a custom MessageFactory</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>MessageFactory</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>sipFactory</strong></span> (advanced)</p></td><td align="left" valign="top"><p>To use a custom SipFactory to create the SipStack to be used</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>SipFactory</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>sipStack</strong></span> (advanced)</p></td><td align="left" valign="top"><p>To use a custom SipStack</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>SipStack</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>sipUri</strong></span> (advanced)</p></td><td align="left" valign="top"><p>To use a custom SipURI. If none configured, then the SipUri fallback to use the options toUser toHost:toPort</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>SipURI</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>synchronous</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Sets whether synchronous processing should be strictly used, or Camel is allowed to use asynchronous processing (if supported).</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>toHeader</strong></span> (advanced)</p></td><td align="left" valign="top"><p>A custom Header object containing message receiver settings. Must implement the type javax.sip.header.ToHeader</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>ToHeader</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>viaHeaders</strong></span> (advanced)</p></td><td align="left" valign="top"><p>List of custom Header objects of the type javax.sip.header.ViaHeader. Each ViaHeader containing a proxy address for request forwarding. (Note this header is automatically updated by each proxy when the request arrives at its listener)</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>List</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>implementationDebugLogFile</strong></span> (logging)</p></td><td align="left" valign="top"><p>Name of client debug log file to use for logging</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>implementationServerLogFile</strong></span> (logging)</p></td><td align="left" valign="top"><p>Name of server log file to use for logging</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>implementationTraceLevel</strong></span> (logging)</p></td><td align="left" valign="top"><p>Logging level for tracing</p></td><td align="center" valign="top"><p>0</p></td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>maxForwards</strong></span> (proxy)</p></td><td align="left" valign="top"><p>Number of maximum proxy forwards</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>int</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>useRouterForAllUris</strong></span> (proxy)</p></td><td align="left" valign="top"><p>This setting is used when requests are sent to the Presence Agent via a proxy.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr></tbody></table></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_sending_messages_to_from_a_sip_endpoint"></a>Sending Messages to/from a SIP endpoint</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="sip-component.html#_creating_a_camel_sip_publisher">Creating a Camel SIP Publisher</a></span></dt><dt><span class="section"><a href="sip-component.html#_creating_a_camel_sip_subscriber">Creating a Camel SIP Subscriber</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_creating_a_camel_sip_publisher"></a>Creating a Camel SIP Publisher</h3></div></div></div><p>In the example below, a SIP Publisher is created to send SIP Event
publications to 
 a user "agent@localhost:5152". This is the address of the SIP Presence
Agent which acts as a broker between the SIP Publisher and Subscriber</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">using a SIP Stack named client</li><li class="listitem">using a registry based eventHeader called evtHdrName</li><li class="listitem">using a registry based eventId called evtId</li><li class="listitem">from a SIP Stack with Listener set up as user2@localhost:3534</li><li class="listitem">The Event being published is EVENT_A</li><li class="listitem">A Mandatory Header called REQUEST_METHOD is set to Request.Publish
thereby setting up the endpoint as a Event publisher"</li></ul></div><pre class="programlisting">producerTemplate.sendBodyAndHeader(
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"sip://agent@localhost:5152?stackName=client&amp;eventHeaderName=evtHdrName&amp;eventId=evtid&amp;fromUser=user2&amp;fromHost=localhost&amp;fromPort=3534"</em></strong>,
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"EVENT_A"</em></strong>,
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"REQUEST_METHOD"</em></strong>,
    Request.PUBLISH);</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_creating_a_camel_sip_subscriber"></a>Creating a Camel SIP Subscriber</h3></div></div></div><p>In the example below, a SIP Subscriber is created to receive SIP Event
publications sent to 
 a user "johndoe@localhost:5154"</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">using a SIP Stack named Subscriber</li><li class="listitem">registering with a Presence Agent user called agent@localhost:5152</li><li class="listitem">using a registry based eventHeader called evtHdrName. The evtHdrName
contains the Event which is se to "Event_A"</li><li class="listitem">using a registry based eventId called evtId</li></ul></div><pre class="programlisting"><em xmlns="http://www.w3.org/1999/xhtml"><span class="hl-annotation" style="color: gray">@Override</span></em>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">protected</strong> RouteBuilder createRouteBuilder() <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">throws</strong> Exception {
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">return</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> RouteBuilder() {
        <em xmlns="http://www.w3.org/1999/xhtml"><span class="hl-annotation" style="color: gray">@Override</span></em>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">public</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">void</strong> configure() <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">throws</strong> Exception {
            <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// Create PresenceAgent</em>
            from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"sip://agent@localhost:5152?stackName=PresenceAgent&amp;presenceAgent=true&amp;eventHeaderName=evtHdrName&amp;eventId=evtid"</em></strong>)
                .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mock:neverland"</em></strong>);

            <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// Create Sip Consumer(Event Subscriber)</em>
            from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"sip://johndoe@localhost:5154?stackName=Subscriber&amp;toUser=agent&amp;toHost=localhost&amp;toPort=5152&amp;eventHeaderName=evtHdrName&amp;eventId=evtid"</em></strong>)
                .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"log:ReceivedEvent?level=DEBUG"</em></strong>)
                .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mock:notification"</em></strong>);

        }
    };
}</pre><p><span class="strong"><strong>The Camel SIP component also ships with a Presence Agent that is meant
to be used for Testing and Demo purposes only.</strong></span> An example of
instantiating a Presence Agent is given above.</p><p>Note that the Presence Agent is set up as a user agent@localhost:5152
and is capable of communicating with both Publisher as well as
Subscriber. It has a separate SIP stackName distinct from Publisher as
well as Subscriber. While it is set up as a Camel Consumer, it does not
actually send any messages along the route to the endpoint
"mock:neverland".</p></div></div></div></body></html>