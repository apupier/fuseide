<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>OPC UA Client Component</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><link rel="home" href="index.html" title="Red Hat Fuse Tooling for Eclipse"><link rel="up" href="IDU-Components.html" title="Part&nbsp;V.&nbsp;Apache Camel Component Reference"><link rel="prev" href="metrics-component.html" title="Metrics Component"><link rel="next" href="milo-server-component.html" title="OPC UA Server Component"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="milo-client-component"></a>OPC UA Client Component</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="milo-client-component.html#_uri_format_122">URI format</a></span></dt><dt><span class="section"><a href="milo-client-component.html#_uri_options_36">URI options</a></span></dt><dt><span class="section"><a href="milo-client-component.html#_see_also_78">See Also</a></span></dt></dl></div><p><span class="strong"><strong>Available as of Camel version 2.19</strong></span></p><p>The <span class="strong"><strong>Milo Client</strong></span> component provides access to OPC UA servers using the
<a class="link" href="http://eclipse.org/milo" target="_top">Eclipse Milo&#8482;</a> implementation.</p><p>Maven users will need to add the following dependency to their <code class="literal">pom.xml</code>
for this component:</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;dependency&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;groupId&gt;</strong>org.apache.camel<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/groupId&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;artifactId&gt;</strong>camel-milo<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/artifactId&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;version&gt;</strong>x.x.x<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/version&gt;</strong>
    <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- use the same version as your Camel core version --&gt;</em>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/dependency&gt;</strong></pre><p>The OPC UA Client component supports 6 options which are listed below.</p><div class="informaltable"><table border="1" width="100%"><colgroup><col width="19%" class="col_1"><col width="51%" class="col_2"><col width="10%" class="col_3"><col width="20%" class="col_4"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Description</th><th align="center" valign="top">Default</th><th align="left" valign="top">Type</th></tr></thead><tbody><tr><td align="left" valign="top"><p><span class="strong"><strong>defaultConfiguration</strong></span> (common)</p></td><td align="left" valign="top"><p>All default options for client</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>MiloClientConfiguration</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>applicationName</strong></span> (common)</p></td><td align="left" valign="top"><p>Default application name</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>applicationUri</strong></span> (common)</p></td><td align="left" valign="top"><p>Default application URI</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>productUri</strong></span> (common)</p></td><td align="left" valign="top"><p>Default product URI</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>reconnectTimeout</strong></span> (common)</p></td><td align="left" valign="top"><p>Default reconnect timeout</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>Long</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>resolveProperty Placeholders</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Whether the component should resolve property placeholders on itself when starting. Only properties which are of String type can use property placeholders.</p></td><td align="center" valign="top"><p>true</p></td><td align="left" valign="top"><p>boolean</p></td></tr></tbody></table></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_uri_format_122"></a>URI format</h2></div></div></div><p>The URI syntax of the endpoint is:</p><pre class="screen">milo-client:tcp://[user:password@]host:port/path/to/service?node=RAW(nsu=urn:foo:bar;s=item-1)</pre><p>If the server does not use a path, then it is possible to simply omit it:</p><pre class="screen">milo-client:tcp://[user:password@]host:port?node=RAW(nsu=urn:foo:bar;s=item-1)</pre><p>If no user credentials are provided the client will switch to anonymous mode.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_uri_options_36"></a>URI options</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="milo-client-component.html#_path_parameters_1_parameters_119">Path Parameters (1 parameters):</a></span></dt><dt><span class="section"><a href="milo-client-component.html#_query_parameters_24_parameters_2">Query Parameters (24 parameters):</a></span></dt><dt><span class="section"><a href="milo-client-component.html#_node_id">Node ID</a></span></dt><dt><span class="section"><a href="milo-client-component.html#_security_policies">Security policies</a></span></dt></dl></div><p>All configuration options in the group client are applicable to the shared client instance. Endpoints
will share client instances for each endpoint URI. So the first time a request for that endpoint URI is
made, the options of the client group are applied. All further instances will be ignored.</p><p>If you need alternate options for the same endpoint URI it is possible though to set the clientId option
which will by added internally to the endpoint URI in order to select a different shared connection instance.
In other words, shared connections located by the combination of endpoint URI and client id.</p><p>The OPC UA Client endpoint is configured using URI syntax:</p><pre class="screen">milo-client:endpointUri</pre><p>with the following path and query parameters:</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_path_parameters_1_parameters_119"></a>Path Parameters (1 parameters):</h3></div></div></div><div class="informaltable"><table border="1" width="100%"><colgroup><col width="19%" class="col_1"><col width="51%" class="col_2"><col width="10%" class="col_3"><col width="20%" class="col_4"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Description</th><th align="center" valign="top">Default</th><th align="left" valign="top">Type</th></tr></thead><tbody><tr><td align="left" valign="top"><p><span class="strong"><strong>endpointUri</strong></span></p></td><td align="left" valign="top"><p><span class="strong"><strong>Required</strong></span> The OPC UA server endpoint</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_query_parameters_24_parameters_2"></a>Query Parameters (24 parameters):</h3></div></div></div><div class="informaltable"><table border="1" width="100%"><colgroup><col width="19%" class="col_1"><col width="51%" class="col_2"><col width="10%" class="col_3"><col width="20%" class="col_4"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Description</th><th align="center" valign="top">Default</th><th align="left" valign="top">Type</th></tr></thead><tbody><tr><td align="left" valign="top"><p><span class="strong"><strong>clientId</strong></span> (common)</p></td><td align="left" valign="top"><p>A virtual client id to force the creation of a new connection instance</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>defaultAwaitWrites</strong></span> (common)</p></td><td align="left" valign="top"><p>Default await setting for writes</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>node</strong></span> (common)</p></td><td align="left" valign="top"><p>The node definition (see Node ID)</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>ExpandedNodeId</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>samplingInterval</strong></span> (common)</p></td><td align="left" valign="top"><p>The sampling interval in milliseconds</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>Double</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>bridgeErrorHandler</strong></span> (consumer)</p></td><td align="left" valign="top"><p>Allows for bridging the consumer to the Camel routing Error Handler, which mean any exceptions occurred while the consumer is trying to pickup incoming messages, or the likes, will now be processed as a message and handled by the routing Error Handler. By default the consumer will use the org.apache.camel.spi.ExceptionHandler to deal with exceptions, that will be logged at WARN or ERROR level and ignored.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>exceptionHandler</strong></span> (consumer)</p></td><td align="left" valign="top"><p>To let the consumer use a custom ExceptionHandler. Notice if the option bridgeErrorHandler is enabled then this options is not in use. By default the consumer will deal with exceptions, that will be logged at WARN or ERROR level and ignored.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>ExceptionHandler</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>exchangePattern</strong></span> (consumer)</p></td><td align="left" valign="top"><p>Sets the exchange pattern when the consumer creates an exchange.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>ExchangePattern</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>synchronous</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Sets whether synchronous processing should be strictly used, or Camel is allowed to use asynchronous processing (if supported).</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>allowedSecurityPolicies</strong></span> (client)</p></td><td align="left" valign="top"><p>A set of allowed security policy URIs. Default is to accept all and use the highest.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>applicationName</strong></span> (client)</p></td><td align="left" valign="top"><p>The application name</p></td><td align="center" valign="top"><p>Apache Camel adapter for Eclipse Milo</p></td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>applicationUri</strong></span> (client)</p></td><td align="left" valign="top"><p>The application URI</p></td><td align="center" valign="top"><p><a class="link" href="http://camel.apache.org/EclipseMilo/Client" target="_top">http://camel.apache.org/EclipseMilo/Client</a></p></td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>channelLifetime</strong></span> (client)</p></td><td align="left" valign="top"><p>Channel lifetime in milliseconds</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>Long</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>keyAlias</strong></span> (client)</p></td><td align="left" valign="top"><p>The name of the key in the keystore file</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>keyPassword</strong></span> (client)</p></td><td align="left" valign="top"><p>The key password</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>keyStorePassword</strong></span> (client)</p></td><td align="left" valign="top"><p>The keystore password</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>keyStoreType</strong></span> (client)</p></td><td align="left" valign="top"><p>The key store type</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>keyStoreUrl</strong></span> (client)</p></td><td align="left" valign="top"><p>The URL where the key should be loaded from</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>URL</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>maxPendingPublishRequests</strong></span> (client)</p></td><td align="left" valign="top"><p>The maximum number of pending publish requests</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>Long</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>maxResponseMessageSize</strong></span> (client)</p></td><td align="left" valign="top"><p>The maximum number of bytes a response message may have</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>Long</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>overrideHost</strong></span> (client)</p></td><td align="left" valign="top"><p>Override the server reported endpoint host with the host from the endpoint URI.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>productUri</strong></span> (client)</p></td><td align="left" valign="top"><p>The product URI</p></td><td align="center" valign="top"><p><a class="link" href="http://camel.apache.org/EclipseMilo" target="_top">http://camel.apache.org/EclipseMilo</a></p></td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>requestTimeout</strong></span> (client)</p></td><td align="left" valign="top"><p>Request timeout in milliseconds</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>Long</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>sessionName</strong></span> (client)</p></td><td align="left" valign="top"><p>Session name</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>sessionTimeout</strong></span> (client)</p></td><td align="left" valign="top"><p>Session timeout in milliseconds</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>Long</p></td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_node_id"></a>Node ID</h3></div></div></div><p>In order to define a target node a namespace and node id is required. In previous versions this was possible by
specifying <code class="literal">nodeId</code> and either <code class="literal">namespaceUri</code> or <code class="literal">namespaceIndex</code>. However this only allowed for using
string based node IDs. And while this configuration is still possible, the newer one is preferred.</p><p>The new approach is to specify a full namespace+node ID in the format <code class="literal">ns=1;i=1</code> which also allows to use the other
node ID formats (like numeric, GUID/UUID or opaque). If the <code class="literal">node</code> parameter is used the older ones must not be used.
The syntax of this node format is a set of <code class="literal">key=value</code> pairs delimited by a semi-colon (<code class="literal">;</code>).</p><p>Exactly one namespace and one node id key must be used. See the following table for possible keys:</p><div class="informaltable"><table border="1" width="100%"><colgroup><col width="22%" class="col_1"><col width="22%" class="col_2"><col width="56%" class="col_3"></colgroup><thead><tr><th align="left" valign="top">Key</th><th align="left" valign="top">Type</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><span class="strong"><strong>ns</strong></span></p></td><td align="left" valign="top"><p>namespace</p></td><td align="left" valign="top"><p>Numeric namespace index</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>nsu</strong></span></p></td><td align="left" valign="top"><p>namespace</p></td><td align="left" valign="top"><p>Namespace URI</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>s</strong></span></p></td><td align="left" valign="top"><p>node</p></td><td align="left" valign="top"><p>String node ID</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>i</strong></span></p></td><td align="left" valign="top"><p>node</p></td><td align="left" valign="top"><p>Numeric node ID</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>g</strong></span></p></td><td align="left" valign="top"><p>node</p></td><td align="left" valign="top"><p>GUID/UUID node ID</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>b</strong></span></p></td><td align="left" valign="top"><p>node</p></td><td align="left" valign="top"><p>Base64 encoded string for opaque node ID</p></td></tr></tbody></table></div><p>As the values generated by the syntax cannot be transparently encoded into a URI parameter value, it is necessary to escape them.
However Camel allows to wrap the actual value inside <code class="literal">RAW(&#8230;)</code>, which makes escaping unnecessary. For example:</p><pre class="screen">milo-client://user:password@localhost:12345?node=RAW(nsu=http://foo.bar;s=foo/bar)</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_security_policies"></a>Security policies</h3></div></div></div><p>When setting the allowing security policies is it possible to use the well known OPC UA URIs (e.g. <code class="literal"><a class="link" href="http://opcfoundation.org/UA/SecurityPolicy#Basic128Rsa15" target="_top">http://opcfoundation.org/UA/SecurityPolicy#Basic128Rsa15</a></code>)
or to use the Milo enum literals (e.g. <code class="literal">None</code>). Specifying an unknown security policy URI or enum is an error.</p><p>The known security policy URIs and enum literals are can be seen here: <a class="link" href="https://github.com/eclipse/milo/blob/master/opc-ua-stack/stack-core/src/main/java/org/eclipse/milo/opcua/stack/core/security/SecurityPolicy.java" target="_top">SecurityPolicy.java</a></p><p><span class="strong"><strong>Note:</strong></span> In any case security policies are considered case sensitive.</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_see_also_78"></a>See Also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Configuring Camel</li><li class="listitem">Component</li><li class="listitem">Endpoint</li><li class="listitem">Getting Started</li></ul></div></div></div></body></html>