<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Publishing your project to Red Hat Fuse</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><link rel="home" href="index.html" title="Red Hat Fuse Tooling for Eclipse"><link rel="up" href="RiderEclipseHelp.html" title="Part&nbsp;I.&nbsp;Tooling Tutorials"><link rel="prev" href="RiderTutorialJUnit.html" title="Testing a route with JUnit"><link rel="next" href="RiderUG.html" title="Part&nbsp;II.&nbsp;Using the Red Hat Fuse Tooling for Eclipse Tools"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="RiderTutDeployFESB"></a>Publishing your project to Red Hat Fuse</h2></div></div></div><p>This tutorial walks you through the process of publishing your project
to Red Hat Fuse. It assumes that you have an instance of Red Hat Fuse
installed on the same machine on which you are running the Red Hat Fuse
Tooling.</p><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_goals_9"></a>Goals</h2></div></div></div><p>In this tutorial you complete the following tasks:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Define a Red Hat Fuse server</li><li class="listitem">Configure the publishing options</li><li class="listitem">Start up the Red Hat Fuse server and publish the <code class="literal">ZooOrderApp</code> project</li><li class="listitem">Connect to the Red Hat Fuse server</li><li class="listitem">Verify whether the <code class="literal">ZooOrderApp</code> project&#8217;s bundle was successfully built and published</li><li class="listitem">Uninstall the <code class="literal">ZooOrderApp</code> project</li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_prerequisites_8"></a>Prerequisites</h2></div></div></div><p>Before you start this tutorial you need:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Access to a Red Hat Fuse instance</li><li class="listitem">Java 8 installed on your computer</li><li class="listitem"><p class="simpara">The <span class="strong"><strong>ZooOrderApp</strong></span> project resulting from one of the following:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p class="simpara">Complete the <a class="xref" href="RiderTutorialJUnit.html" title="Testing a route with JUnit"><i>Testing a route with JUnit</i></a> tutorial.</p><p class="simpara">or</p></li><li class="listitem">Complete the <a class="xref" href="RiderTutorialSetup.html" title="Setting up your environment"><i>Setting up your environment</i></a>  tutorial and replace your project&#8217;s <code class="literal">blueprint.xml</code> file with the provided <code class="literal">blueprintContexts/blueprint3.xml</code> file, as described in <a class="xref" href="RiderTutorialIntro.html#AboutResourceFiles" title="About the resource files">About the resource files</a>.</li></ul></div></li></ul></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_defining_a_red_hat_fuse_server"></a>Defining a Red Hat Fuse Server</h2></div></div></div><p>To define a server:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">Open the <span class="strong"><strong>Fuse Integration</strong></span> perspective.</li><li class="listitem">Click the <span class="strong"><strong>Servers</strong></span> tab in the lower, right panel to open the
<span class="strong"><strong>Servers</strong></span> view.</li><li class="listitem"><p class="simpara">Click the <span class="strong"><strong>No servers are available. Click this link to create a
new server&#8230;&#8203;</strong></span> link to open the <span class="strong"><strong>Define a New Server</strong></span> page.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>To define a new server when one is already defined, right-click inside the
<span class="strong"><strong>Servers</strong></span> view and then select <span class="strong"><strong>New</strong></span> &#8594; <span class="strong"><strong>Server</strong></span>.</p></td></tr></table></div></li><li class="listitem"><p class="simpara">Expand the <span class="strong"><strong>Red Hat JBoss Middleware</strong></span> node to expose the available server options:</p><div class="informalfigure"><div class="mediaobject"><img src="images/tutDefineNewServer.png" alt="tutDefineNewServer"></div></div></li><li class="listitem">Select a Red Hat Fuse server.</li><li class="listitem"><p class="simpara">Accept the defaults for <span class="strong"><strong>Server&#8217;s host name</strong></span>
(<span class="emphasis"><em>localhost</em></span>) and <span class="strong"><strong>Server name</strong></span>
(Fuse <span class="emphasis"><em>n.n</em></span> Runtime Server), and then click
<span class="strong"><strong>Next</strong></span> to open the <span class="strong"><strong>Runtime</strong></span> page:</p><div class="informalfigure"><div class="mediaobject"><img src="images/tutFuseRuntimeDef1.png" alt="tutFuseRuntimeDef1"></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>If you do not have Fuse already installed, you can download it now using the
<span class="strong"><strong>Download and install runtime</strong></span> link.</p><p>If you have already defined a server, the tooling skips this page, and instead
displays the configuration details page.</p></td></tr></table></div></li><li class="listitem">Accept the default for <span class="strong"><strong>Name</strong></span>.</li><li class="listitem">Click <span class="strong"><strong>Browse</strong></span> next to the <span class="strong"><strong>Home Directory</strong></span> field, to
navigate to the installation and select it.</li><li class="listitem"><p class="simpara">Select the runtime JRE from the drop-down menu next to <span class="strong"><strong>Execution
Environment</strong></span>.</p><p class="simpara">Select JavaSE-1.8 (recommended). If necessary, click the <span class="strong"><strong>Environments</strong></span> button to  select it from the list.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>The Fuse server requires Java 8 (recommended). To select it for the <span class="strong"><strong>Execution Environment</strong></span>, you must have previously installed it.</p></td></tr></table></div></li><li class="listitem">Leave the <span class="strong"><strong>Alternate JRE</strong></span> option as is.</li><li class="listitem"><p class="simpara">Click <span class="strong"><strong>Next</strong></span> to save the runtime definition for the Fuse Server and open the <span class="strong"><strong>Fuse server configuration
details</strong></span> page:</p><div class="informalfigure"><div class="mediaobject"><img src="images/NewServerDetailsTut.png" alt="NewServerDetailsTut"></div></div></li><li class="listitem"><p class="simpara">Accept the default for <span class="strong"><strong>SSH Port</strong></span>
(<span class="emphasis"><em>8101</em></span>).</p><p class="simpara">The runtime uses the SSH port to connect to the server&#8217;s Karaf shell. If this
default is incorrect, you can discover the correct port number by looking in the
Red Hat Fuse
<code class="literal"><span class="emphasis"><em>installDir</em></span>/etc/org.apache.karaf.shell.cfg</code>
file.</p></li><li class="listitem"><p class="simpara">In <span class="strong"><strong>User Name</strong></span>, enter the name used to log into the server.</p><p class="simpara">This is a user name stored in the Red Hat Fuse
<span class="emphasis"><em>installDir</em></span>`/etc/users.properties` file.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>If the default user has been activated (uncommented) in the
<code class="literal">/etc/users.properties</code> file, the tooling autofills
<span class="strong"><strong>User Name</strong></span> and <span class="strong"><strong>Password</strong></span> with
the default user&#8217;s name and password.</p></td></tr></table></div><p class="simpara">If one has not been set, you can either add one to that file using the format
<code class="literal">user=password,role</code> (for example,
<code class="literal">joe=secret,Administrator</code>), or you can set one using the karaf
<code class="literal">jaas</code> command set:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><code class="literal">jaas:realms</code>&#8201;&#8212;&#8201;to list the realms</li><li class="listitem"><code class="literal">jaas:manage --index 1</code>&#8201;&#8212;&#8201;to edit the first
(server) realm</li><li class="listitem"><code class="literal">jaas:useradd &lt;username&gt;
&lt;password&gt;</code>&#8201;&#8212;&#8201;to add a user and associated
password</li><li class="listitem"><code class="literal">jaas:roleadd &lt;username&gt; Administrator</code>&#8201;&#8212;&#8201;to
specify the new user&#8217;s role</li><li class="listitem"><p class="simpara"><code class="literal">jaas:update</code>&#8201;&#8212;&#8201;to update the realm with the
new user information</p><p class="simpara">If a jaas realm has already been selected for the server, you can discover the
user name by issuing the command
<code class="literal">JBossFuse:karaf@root&gt;</code><code class="literal">jaas:users</code>.</p></li></ul></div></li><li class="listitem"><p class="simpara">In <span class="strong"><strong>Password</strong></span>, type the password required for
<span class="strong"><strong>User name</strong></span> to log into the server.</p><p class="simpara">This is the password set either in Red Hat Fuse&#8217;s
<code class="literal"><span class="emphasis"><em>installDir</em></span>/etc/users.properties</code>
file or by the karaf <code class="literal">jaas</code> commands.</p></li><li class="listitem"><p class="simpara">Click <span class="strong"><strong>Finish</strong></span>.</p><p class="simpara"><span class="strong"><strong>Runtime Server [stopped, Synchronized]</strong></span> appears in the <span class="strong"><strong>Servers</strong></span> view.</p></li><li class="listitem"><p class="simpara">In the <span class="strong"><strong>Servers</strong></span> view, expand <span class="strong"><strong>Runtime Server [stopped, Synchronized]</strong></span>:</p><div class="informalfigure"><div class="mediaobject"><img src="images/JBFuseServersView.png" alt="JBFuseServersView"></div></div><p class="simpara"><span class="strong"><strong>JMX[Disconnected]</strong></span> appears as a node under the <span class="strong"><strong>Runtime Server [stopped, Synchronized]</strong></span>
entry.</p></li></ol></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_configuring_the_publishing_options"></a>Configuring the publishing options</h2></div></div></div><p>Using publishing options, you can configure how and when your
<code class="literal">ZooOrderApp</code> project is published to a running server:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Automatically, immediately upon saving changes made to the project</li><li class="listitem">Automatically, at configured intervals after you have changed and saved
the project</li><li class="listitem">Manually, when you select a publish operation</li></ul></div><p>In this tutorial, you configure immediate publishing upon saving changes
to the <code class="literal">ZooOrderApp</code> project. To do so:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">In the <span class="strong"><strong>Servers</strong></span> view, double-click
the <span class="strong"><strong>Runtime Server [stopped, Synchronized]</strong></span> entry to display its
overview.</li><li class="listitem"><p class="simpara">On the server&#8217;s <span class="strong"><strong>Overview</strong></span> page, expand the <span class="strong"><strong>Publishing</strong></span>
section to expose the options.</p><div class="informalfigure"><div class="mediaobject"><img src="images/srvEditorPubOpts.png" alt="srvEditorPubOpts"></div></div><p class="simpara">Make sure that the option <span class="strong"><strong>Automatically publish when resources change</strong></span> is
enabled.</p><p class="simpara">Optionally, change the value of <span class="strong"><strong>Publishing interval</strong></span> to speed up
or delay publishing the project when changes have been made.</p></li><li class="listitem">In the <span class="strong"><strong>Servers</strong></span> view, click <span class="inlinemediaobject"><img src="./images/run_exec.png" alt="Start the server"></span>.</li><li class="listitem"><p class="simpara">Wait a few seconds for the server to start. When it does:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p class="simpara">The <span class="strong"><strong>Terminal</strong></span> view displays the splash screen:</p><div class="informalfigure"><div class="mediaobject"><img src="images/tutServerStartShellV.png" alt="tutServerStartShellV"></div></div></li><li class="listitem"><p class="simpara">The <span class="strong"><strong>Servers</strong></span> view displays:</p><div class="informalfigure"><div class="mediaobject"><img src="images/tutServerStartServerV.png" alt="tutServerStartServerV"></div></div></li><li class="listitem"><p class="simpara">The <span class="strong"><strong>JMX Navigator</strong></span> displays <span class="strong"><strong><span class="emphasis"><em>n.n</em></span> Runtime Server[Disconnected</strong></span>:</p><div class="informalfigure"><div class="mediaobject"><img src="images/tutServerStartJMXNav.png" alt="tutServerStartJMXNav"></div></div></li></ul></div></li><li class="listitem"><p class="simpara">In the <span class="strong"><strong>Servers</strong></span> view, right-click <span class="strong"><strong><span class="emphasis"><em>n.n</em></span> Runtime Server [Started]</strong></span> and then select
<span class="strong"><strong>Add and Remove</strong></span> to open the <span class="strong"><strong>Add and Remove</strong></span> page:</p><div class="informalfigure"><div class="mediaobject"><img src="images/tutAddRemove1.png" alt="tutAddRemove1"></div></div><p class="simpara">Make sure the option <span class="strong"><strong>If server is started, publish changes immediately</strong></span> is checked.</p></li><li class="listitem"><p class="simpara">Select <code class="literal">ZooOrderApp</code> and click <span class="strong"><strong>Add</strong></span> to assign it to the Fuse server:</p><div class="informalfigure"><div class="mediaobject"><img src="images/tutAddRemove2.png" alt="tutAddRemove2"></div></div></li><li class="listitem"><p class="simpara">Click <span class="strong"><strong>Finish</strong></span>.</p><p class="simpara">The <span class="strong"><strong>Servers</strong></span> view should show the following:</p><div class="informalfigure"><div class="mediaobject"><img src="images/tutCBRrtePublishedSrvV.png" alt="tutCBRrtePublishedSrvV"></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p class="simpara"><span class="strong"><strong>Runtime Server [Started, Synchronized]</strong></span></p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>For a server, <span class="strong"><strong>synchronized</strong></span>
means that all modules published on the server are identical to their local
counterparts.</p></td></tr></table></div></li><li class="listitem"><p class="simpara"><span class="strong"><strong>ZooOrderApp [Started, Synchronized]</strong></span></p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>For a module, <span class="strong"><strong>synchronized</strong></span>
means that the published module is identical to its local counterpart.
Because automatic publishing is enabled, changes made to the
ZooOrderApp project are published in seconds (according to the value
of the <span class="strong"><strong>Publishing interval</strong></span>).</p></td></tr></table></div></li><li class="listitem"><span class="strong"><strong>JMX[Disconnected]</strong></span></li></ul></div></li></ol></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_connecting_to_the_runtime_server"></a>Connecting to the runtime server</h2></div></div></div><p>After you connect to the runtime server, you can see the published elements of your <code class="literal">ZooOrderApp</code> project and interact
with them.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">In the <span class="strong"><strong>Servers</strong></span> view, double-click <span class="strong"><strong>JMX[Disconnected]</strong></span> to connect to the runtime
server.</li><li class="listitem"><p class="simpara">In the <span class="strong"><strong>JMX Navigator</strong></span>, expand the <code class="literal">Camel</code> folder to expose the elements of the <code class="literal">ZooOrderApp</code>.</p><div class="informalfigure"><div class="mediaobject"><img src="images/tutJMXconnected.png" alt="tutJMXconnected"></div></div></li><li class="listitem"><p class="simpara">Click the <span class="strong"><strong>Bundles</strong></span> node to populate the
<span class="strong"><strong>Properties</strong></span> view with the list of bundles
installed on the runtime server:</p><div class="informalfigure"><div class="mediaobject"><img src="images/tutCBRrouteBundleInstall.png" alt="tutCBRrouteBundleInstall"></div></div></li><li class="listitem"><p class="simpara">In the <span class="strong"><strong>Search</strong></span> field, type ZooOrderApp. The corresponding <code class="literal">com.mycompany.camel-blueprint</code> bundle is shown:</p><div class="informalfigure"><div class="mediaobject"><img src="images/tutCBRrouteBundleSearch.png" alt="tutCBRrouteBundleSearch"></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>Alternatively, you can issue the <code class="literal">osgi:list</code> command in the <span class="strong"><strong>Terminal</strong></span> view to see a generated list of bundles installed on the  server runtime. The tooling uses a different naming scheme for OSGi bundles displayed by the <code class="literal">osgi:list</code> command. In this case, the command returns <code class="literal">Camel Blueprint Quickstart</code>, which appears at the end of the list of installed bundles.</p><p>In the <code class="literal">&lt;build&gt;</code> section of project&#8217;s <code class="literal">pom.xml</code> file, you can find the bundle&#8217;s symbolic name and its bundle name (OSGi) listed in the <code class="literal">maven-bundle-plugin</code> entry:</p><div class="informalfigure"><div class="mediaobject"><img src="images/tutBundleNamesPom.png" alt="tutBundleNamesPom"></div></div></td></tr></table></div></li></ol></div></div><div class="simplesect"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_uninstalling_the_zooorderapp_project"></a>Uninstalling the ZooOrderApp project</h2></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>You do not need to disconnect the JMX connection or stop the server to uninstall a
published resource.</p></td></tr></table></div><p>To remove the <code class="literal">ZooOrderApp</code> resource from the  runtime server:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">In the <span class="strong"><strong>Servers</strong></span> view, right-click <span class="strong"><strong><span class="emphasis"><em>n.n</em></span> Runtime Server</strong></span> to open the context menu.</li><li class="listitem"><p class="simpara">Select <span class="strong"><strong>Add and Remove</strong></span>:</p><div class="informalfigure"><div class="mediaobject"><img src="images/tutUnpubCBRroute.png" alt="tutUnpubCBRroute"></div></div></li><li class="listitem">In the <span class="strong"><strong>Configured</strong></span> column, select
<code class="literal">ZooOrderApp</code>, and then click <span class="strong"><strong>Remove</strong></span>
to move the <code class="literal">ZooOrderApp</code> resource to the
<span class="strong"><strong>Available</strong></span> column.</li><li class="listitem">Click <span class="strong"><strong>Finish</strong></span>.</li><li class="listitem"><p class="simpara">In the <span class="strong"><strong>Servers</strong></span> view, right-click <span class="strong"><strong>JMX[Connected]</strong></span> and then click <span class="strong"><strong>Refresh</strong></span>.</p><p class="simpara">The <code class="literal">Camel</code> tree under <span class="strong"><strong>JMX[Connected]</strong></span> disappears.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="imagesdb/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>In <span class="strong"><strong>JMX Navigator</strong></span>, the <code class="literal">Camel</code> tree under <span class="strong"><strong>Server Connections</strong></span> &gt; <span class="strong"><strong><span class="emphasis"><em>n.n</em></span> Runtime Server[Connected]</strong></span> also disappears.</p></td></tr></table></div></li><li class="listitem">With the <span class="strong"><strong>Bundles</strong></span> page displayed in the <span class="strong"><strong>Properties</strong></span> view, scroll down to the end of the list to verify that the ZooOrderApp&#8217;s bundle is no longer listed.</li></ol></div></div></div></body></html>