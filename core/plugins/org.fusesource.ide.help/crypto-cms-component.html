<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Crypto CMS Component</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><link rel="home" href="index.html" title="Red Hat Fuse Tooling for Eclipse"><link rel="up" href="IDU-Components.html" title="Part&nbsp;V.&nbsp;Apache Camel Component Reference"><link rel="prev" href="crypto-component.html" title="Crypto (JCE) Component"><link rel="next" href="crypto-dataformat.html" title="Crypto (Java Cryptographic Extension) DataFormat"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="crypto-cms-component"></a>Crypto CMS Component</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="crypto-cms-component.html#_options_27">Options</a></span></dt><dt><span class="section"><a href="crypto-cms-component.html#_enveloped_data">Enveloped Data</a></span></dt><dt><span class="section"><a href="crypto-cms-component.html#_signed_data">Signed Data</a></span></dt></dl></div><p><span class="strong"><strong>Available as of Camel version 2.20</strong></span></p><p><a class="link" href="http://tools.ietf.org/html/rfc5652" target="_top">Cryptographic Message Syntax (CMS)</a> is a well established standard for signing and encrypting messages. The Apache Crypto CMS component supports the following parts of this standard:
* Content Type "Enveloped Data" with Key Transport (asymmetric key),
* Content Type "Signed Data".
You can create CMS Enveloped Data instances, decrypt CMS Enveloped Data instances, create CMS Signed Data instances, and validate CMS Signed Data instances.</p><p>The component uses the <a class="link" href="https://www.bouncycastle.org/java.html" target="_top">Bouncy Castle</a> libraries bcprov-jdk15on and bcpkix-jdk15on.</p><p>Maven users will need to add the following dependency to their <code class="literal">pom.xml</code> for this component:</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;dependency&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;groupId&gt;</strong>org.apache.camel<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/groupId&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;artifactId&gt;</strong>camel-crypto-cms<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/artifactId&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;version&gt;</strong>x.x.x<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/version&gt;</strong>
    <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- use the same version as your Camel core version --&gt;</em>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/dependency&gt;</strong></pre><p>We recommend to register the Bouncy Castle security provider in your application before you call an endpoint of this component:</p><pre class="programlisting">Security.addProvider(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> BouncyCastleProvider());</pre><p>If the Bouncy Castle security provider is not registered then the Crypto CMS component will register the provider.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_options_27"></a>Options</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="crypto-cms-component.html#_path_parameters_2_parameters_10">Path Parameters (2 parameters):</a></span></dt><dt><span class="section"><a href="crypto-cms-component.html#_query_parameters_15_parameters">Query Parameters (15 parameters):</a></span></dt></dl></div><p>The Crypto CMS component supports 3 options which are listed below.</p><div class="informaltable"><table border="1" width="100%"><colgroup><col width="19%" class="col_1"><col width="51%" class="col_2"><col width="10%" class="col_3"><col width="20%" class="col_4"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Description</th><th align="center" valign="top">Default</th><th align="left" valign="top">Type</th></tr></thead><tbody><tr><td align="left" valign="top"><p><span class="strong"><strong>signedDataVerifier Configuration</strong></span> (advanced)</p></td><td align="left" valign="top"><p>To configure the shared SignedDataVerifierConfiguration, which determines the uri parameters for the verify operation.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>SignedDataVerifier Configuration</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>envelopedDataDecryptor Configuration</strong></span> (advanced)</p></td><td align="left" valign="top"><p>To configure the shared EnvelopedDataDecryptorConfiguration, which determines the uri parameters for the decrypt operation.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>EnvelopedDataDecryptor Configuration</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>resolveProperty Placeholders</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Whether the component should resolve property placeholders on itself when starting. Only properties which are of String type can use property placeholders.</p></td><td align="center" valign="top"><p>true</p></td><td align="left" valign="top"><p>boolean</p></td></tr></tbody></table></div><p>The Crypto CMS endpoint is configured using URI syntax:</p><pre class="screen">crypto-cms:cryptoOperation:name</pre><p>with the following path and query parameters:</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_path_parameters_2_parameters_10"></a>Path Parameters (2 parameters):</h3></div></div></div><div class="informaltable"><table border="1" width="100%"><colgroup><col width="19%" class="col_1"><col width="51%" class="col_2"><col width="10%" class="col_3"><col width="20%" class="col_4"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Description</th><th align="center" valign="top">Default</th><th align="left" valign="top">Type</th></tr></thead><tbody><tr><td align="left" valign="top"><p><span class="strong"><strong>cryptoOperation</strong></span></p></td><td align="left" valign="top"><p><span class="strong"><strong>Required</strong></span> Set the Crypto operation from that supplied after the crypto scheme in the endpoint uri e.g. crypto-cms:sign sets sign as the operation. Possible values: sign, verify, encrypt, or decrypt.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>CryptoOperation</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>name</strong></span></p></td><td align="left" valign="top"><p><span class="strong"><strong>Required</strong></span> The name part in the URI can be chosen by the user to distinguish between different signer/verifier/encryptor/decryptor endpoints within the camel context.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_query_parameters_15_parameters"></a>Query Parameters (15 parameters):</h3></div></div></div><div class="informaltable"><table border="1" width="100%"><colgroup><col width="19%" class="col_1"><col width="51%" class="col_2"><col width="10%" class="col_3"><col width="20%" class="col_4"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Description</th><th align="center" valign="top">Default</th><th align="left" valign="top">Type</th></tr></thead><tbody><tr><td align="left" valign="top"><p><span class="strong"><strong>keyStore</strong></span> (common)</p></td><td align="left" valign="top"><p>Keystore which contains signer private keys, verifier public keys, encryptor public keys, decryptor private keys depending on the operation. Use either this parameter or the parameter 'keyStoreParameters'.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>KeyStore</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>keyStoreParameters</strong></span> (common)</p></td><td align="left" valign="top"><p>Keystore containing signer private keys, verifier public keys, encryptor public keys, decryptor private keys depending on the operation. Use either this parameter or the parameter 'keystore'.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>KeyStoreParameters</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>synchronous</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Sets whether synchronous processing should be strictly used, or Camel is allowed to use asynchronous processing (if supported).</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>password</strong></span> (decrypt)</p></td><td align="left" valign="top"><p>Sets the password of the private keys. It is assumed that all private keys in the keystore have the same password. If not set then it is assumed that the password of the private keys is given by the keystore password given in the KeyStoreParameters.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>Char[]</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>fromBase64</strong></span> (decrypt_verify)</p></td><td align="left" valign="top"><p>If true then the CMS message is base 64 encoded and must be decoded during the processing. Default value is false.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>Boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>contentEncryptionAlgorithm</strong></span> (encrypt)</p></td><td align="left" valign="top"><p>Encryption algorithm, for example DESede/CBC/PKCS5Padding. Further possible values: DESede/CBC/PKCS5Padding, AES/CBC/PKCS5Padding, Camellia/CBC/PKCS5Padding, CAST5/CBC/PKCS5Padding.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>originatorInformation Provider</strong></span> (encrypt)</p></td><td align="left" valign="top"><p>Provider for the originator info. See <a class="link" href="https://tools.ietf.org/html/rfc5652section-6.1" target="_top">https://tools.ietf.org/html/rfc5652section-6.1</a>. The default value is null.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>OriginatorInformation Provider</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>recipient</strong></span> (encrypt)</p></td><td align="left" valign="top"><p>Recipient Info: reference to a bean which implements the interface org.apache.camel.component.crypto.cms.api.TransRecipientInfo</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>List</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>secretKeyLength</strong></span> (encrypt)</p></td><td align="left" valign="top"><p>Key length for the secret symmetric key used for the content encryption. Only used if the specified content-encryption algorithm allows keys of different sizes. If contentEncryptionAlgorithm=AES/CBC/PKCS5Padding or Camellia/CBC/PKCS5Padding then 128; if contentEncryptionAlgorithm=DESede/CBC/PKCS5Padding then 192, 128; if strong encryption is enabled then for AES/CBC/PKCS5Padding and Camellia/CBC/PKCS5Padding also the key lengths 192 and 256 are possible.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>int</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>unprotectedAttributes GeneratorProvider</strong></span> (encrypt)</p></td><td align="left" valign="top"><p>Provider of the generator for the unprotected attributes. The default value is null which means no unprotected attribute is added to the Enveloped Data object. See <a class="link" href="https://tools.ietf.org/html/rfc5652section-6.1" target="_top">https://tools.ietf.org/html/rfc5652section-6.1</a>.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>AttributesGenerator Provider</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>toBase64</strong></span> (encrypt_sign)</p></td><td align="left" valign="top"><p>Indicates whether the Signed Data or Enveloped Data instance shall be base 64 encoded. Default value is false.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>Boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>includeContent</strong></span> (sign)</p></td><td align="left" valign="top"><p>Indicates whether the signed content should be included into the Signed Data instance. If false then a detached Signed Data instance is created in the header CamelCryptoCmsSignedData.</p></td><td align="center" valign="top"><p>true</p></td><td align="left" valign="top"><p>Boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>signer</strong></span> (sign)</p></td><td align="left" valign="top"><p>Signer information: reference to a bean which implements org.apache.camel.component.crypto.cms.api.SignerInfo</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>List</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>signedDataHeaderBase64</strong></span> (verify)</p></td><td align="left" valign="top"><p>Indicates whether the value in the header CamelCryptoCmsSignedData is base64 encoded. Default value is false. Only relevant for detached signatures. In the detached signature case, the header contains the Signed Data object.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>Boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>verifySignaturesOfAll Signers</strong></span> (verify)</p></td><td align="left" valign="top"><p>If true then the signatures of all signers contained in the Signed Data object are verified. If false then only one signature whose signer info matches with one of the specified certificates is verified. Default value is true.</p></td><td align="center" valign="top"><p>true</p></td><td align="left" valign="top"><p>Boolean</p></td></tr></tbody></table></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_enveloped_data"></a>Enveloped Data</h2></div></div></div><p>Note, that a <code class="literal">crypto-cms:encypt</code> endpoint is typically defined in one route and the complimentary <code class="literal">crypto-cms:decrypt</code> in another, though for simplicity in the
examples they appear one after the other.</p><p>The following example shows how you can create an Enveloped Data message and how you can decrypt an Enveloped Data message.</p><p><span class="strong"><strong>Basic Example in Java DSL</strong></span></p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> org.apache.camel.util.jsse.KeyStoreParameters;
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> org.apache.camel.component.crypto.cms.crypt.DefaultKeyTransRecipientInfo;
...
KeyStoreParameters keystore  = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> KeyStoreParameters();
keystore.setType(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"JCEKS"</em></strong>);
keystore.setResource(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"keystore/keystore.jceks);
</em></strong>keystore.setPassword(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"some_password"</em></strong>); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// this password will also be used for accessing the private key if not specified in the crypto-cms:decrypt endpoint</em>

DefaultKeyTransRecipientInfo recipient1 = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> DefaultKeyTransRecipientInfo();
recipient1.setCertificateAlias(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"rsa"</em></strong>); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// alias of the public key used for the encryption</em>
recipient1.setKeyStoreParameters(keystore);

simpleReg.put(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"keyStoreParameters"</em></strong>, keystore); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// register keystore in the registry</em>
simpleReg.put(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"recipient1"</em></strong>, recipient1); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// register recipient info in the registry</em>

from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:start"</em></strong>)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"crypto-cms:encrypt://testencrpyt?toBase64=true&amp;recipient=#recipient1&amp;contentEncryptionAlgorithm=DESede/CBC/PKCS5Padding&amp;secretKeyLength=128"</em></strong>)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"crypto-cms:decrypt://testdecrypt?fromBase64=true&amp;keyStoreParameters=#keyStoreParameters"</em></strong>)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mock:result"</em></strong>);</pre><p><span class="strong"><strong>Basic Example in Spring XML</strong></span></p><pre class="programlisting">   <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;keyStoreParameters</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">xmlns</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://camel.apache.org/schema/spring"</span>
        <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"keyStoreParameters1"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">resource</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"./keystore/keystore.jceks"</span>
        <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">password</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"some_password"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">type</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"JCEKS"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;bean</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"recipient1"</span>
        <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">class</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"org.apache.camel.component.crypto.cms.crypt.DefaultKeyTransRecipientInfo"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"keyStoreParameters"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">ref</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"keyStoreParameters1"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"certificateAlias"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"rsa"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/bean&gt;</strong>
...
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;route&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;from</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"direct:start"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"crypto-cms:encrypt://testencrpyt?toBase64=true&amp;amp;recipient=#recipient1&amp;amp;contentEncryptionAlgorithm=DESede/CBC/PKCS5Padding&amp;amp;secretKeyLength=128"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"crypto-cms:decrypt://testdecrypt?fromBase64=true&amp;amp;keyStoreParameters=#keyStoreParameters1"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
         <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"mock:result"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/route&gt;</strong></pre><p><span class="strong"><strong>Two Recipients in Java DSL</strong></span></p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> org.apache.camel.util.jsse.KeyStoreParameters;
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> org.apache.camel.component.crypto.cms.crypt.DefaultKeyTransRecipientInfo;
...
KeyStoreParameters keystore  = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> KeyStoreParameters();
keystore.setType(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"JCEKS"</em></strong>);
keystore.setResource(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"keystore/keystore.jceks);
</em></strong>keystore.setPassword(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"some_password"</em></strong>); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// this password will also be used for accessing the private key if not specified in the crypto-cms:decrypt endpoint</em>

DefaultKeyTransRecipientInfo recipient1 = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> DefaultKeyTransRecipientInfo();
recipient1.setCertificateAlias(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"rsa"</em></strong>); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// alias of the public key used for the encryption</em>
recipient1.setKeyStoreParameters(keystore);

DefaultKeyTransRecipientInfo recipient2 = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> DefaultKeyTransRecipientInfo();
recipient2.setCertificateAlias(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"dsa"</em></strong>);
recipient2.setKeyStoreParameters(keystore);

simpleReg.put(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"keyStoreParameters"</em></strong>, keystore); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// register keystore in the registry</em>
simpleReg.put(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"recipient1"</em></strong>, recipient1); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// register recipient info in the registry</em>

from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:start"</em></strong>)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"crypto-cms:encrypt://testencrpyt?toBase64=true&amp;recipient=#recipient1&amp;recipient=#recipient2&amp;contentEncryptionAlgorithm=DESede/CBC/PKCS5Padding&amp;secretKeyLength=128"</em></strong>)
    <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//the decryptor will automatically choose one of the two private keys depending which one is in the decryptor keystore</em>
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"crypto-cms:decrypt://testdecrypt?fromBase64=true&amp;keyStoreParameters=#keyStoreParameters"</em></strong>)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mock:result"</em></strong>);</pre><p><span class="strong"><strong>Two Recipients in Spring XML</strong></span></p><pre class="programlisting">   <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;keyStoreParameters</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">xmlns</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://camel.apache.org/schema/spring"</span>
        <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"keyStoreParameters1"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">resource</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"./keystore/keystore.jceks"</span>
        <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">password</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"some_password"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">type</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"JCEKS"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;bean</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"recipient1"</span>
        <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">class</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"org.apache.camel.component.crypto.cms.crypt.DefaultKeyTransRecipientInfo"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"keyStoreParameters"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">ref</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"keyStoreParameters1"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"certificateAlias"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"rsa"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/bean&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;bean</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"recipient2"</span>
        <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">class</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"org.apache.camel.component.crypto.cms.crypt.DefaultKeyTransRecipientInfo"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"keyStoreParameters"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">ref</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"keyStoreParameters1"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"certificateAlias"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"dsa"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/bean&gt;</strong>
...
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;route&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;from</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"direct:start"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"crypto-cms:encrypt://testencrpyt?toBase64=true&amp;amp;recipient=#recipient1&amp;amp;recipient=#recipient2&amp;amp;contentEncryptionAlgorithm=DESede/CBC/PKCS5Padding&amp;amp;secretKeyLength=128"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
        <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- the decryptor will automatically choose one of the two private keys depending which one is in the decryptor keystore --&gt;</em>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"crypto-cms:decrypt://testdecrypt?fromBase64=true&amp;amp;keyStoreParameters=#keyStoreParameters1"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
         <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"mock:result"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/route&gt;</strong></pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_signed_data"></a>Signed Data</h2></div></div></div><p>Note, that a <code class="literal">crypto-cms:sign</code> endpoint is typically defined in one route and the complimentary <code class="literal">crypto-cms:verify</code> in another, though for simplicity in the
examples they appear one after the other.</p><p>The following example shows how you can create a Signed Data message and how you can validate a Signed Data message.</p><p><span class="strong"><strong>Basic Example in Java DSL</strong></span></p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> org.apache.camel.util.jsse.KeyStoreParameters;
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> org.apache.camel.component.crypto.cms.sig.DefaultSignerInfo;
...
KeyStoreParameters keystore  = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> KeyStoreParameters();
keystore.setType(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"JCEKS"</em></strong>);
keystore.setResource(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"keystore/keystore.jceks);
</em></strong>keystore.setPassword(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"some_password"</em></strong>); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// this password will also be used for accessing the private key if not specified in the signerInfo1 bean</em>

<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//Signer Information, by default the following signed attributes are included: contentType, signingTime, messageDigest, and cmsAlgorithmProtect; by default no unsigned attribute is included.</em>
<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// If you want to add your own signed attributes or unsigned attributes, see methods DefaultSignerInfo.setSignedAttributeGenerator and DefaultSignerInfo.setUnsignedAttributeGenerator.</em>
DefaultSignerInfo signerInfo1 = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> DefaultSignerInfo();
signerInfo1.setIncludeCertificates(true); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// if set to true then the certificate chain of the private key will be added to the Signed Data object</em>
signerInfo1.setSignatureAlgorithm(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"SHA256withRSA"</em></strong>); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// signature algorithm; attention, the signature algorithm must fit to the signer private key.</em>
signerInfo1.setPrivateKeyAlias(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"rsa"</em></strong>); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// alias of the private key used for the signing</em>
signerInfo1.setPassword(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"private_key_pw"</em></strong>.toCharArray()); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// optional parameter, if not set then the password of the KeyStoreParameters will be used for accessing the private key</em>
signerInfo1.setKeyStoreParameters(keystore);

simpleReg.put(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"keyStoreParameters"</em></strong>, keystore); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//register keystore in the registry</em>
simpleReg.put(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"signer1"</em></strong>, signerInfo1); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//register signer info in the registry</em>

from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:start"</em></strong>)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"crypto-cms:sign://testsign?signer=#signer1&amp;includeContent=true&amp;toBase64=true"</em></strong>)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"crypto-cms:verify://testverify?keyStoreParameters=#keyStoreParameters&amp;fromBase64=true"</em></strong><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">")
</em></strong>    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mock:result"</em></strong>);</pre><p><span class="strong"><strong>Basic Example in Spring XML</strong></span></p><pre class="programlisting">   <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;keyStoreParameters</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">xmlns</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://camel.apache.org/schema/spring"</span>
        <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"keyStoreParameters1"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">resource</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"./keystore/keystore.jceks"</span>
        <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">password</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"some_password"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">type</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"JCEKS"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;bean</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"signer1"</span>
        <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">class</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"org.apache.camel.component.crypto.cms.sig.DefaultSignerInfo"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"keyStoreParameters"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">ref</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"keyStoreParameters1"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"privateKeyAlias"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"rsa"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"signatureAlgorithm"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"SHA256withRSA"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"includeCertificates"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"true"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
        <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- optional parameter 'password', if not set then the password of the KeyStoreParameters will be used for accessing the private key --&gt;</em>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"password"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"private_key_pw"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/bean&gt;</strong>
...
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;route&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;from</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"direct:start"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"crypto-cms:sign://testsign?signer=#signer1&amp;amp;includeContent=true&amp;amp;toBase64=true"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"crypto-cms:verify://testverify?keyStoreParameters=#keyStoreParameters1&amp;amp;fromBase64=true"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"mock:result"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/route&gt;</strong></pre><p><span class="strong"><strong>Example with two Signers in Java DSL</strong></span></p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> org.apache.camel.util.jsse.KeyStoreParameters;
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> org.apache.camel.component.crypto.cms.sig.DefaultSignerInfo;
...
KeyStoreParameters keystore  = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> KeyStoreParameters();
keystore.setType(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"JCEKS"</em></strong>);
keystore.setResource(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"keystore/keystore.jceks);
</em></strong>keystore.setPassword(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"some_password"</em></strong>); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// this password will also be used for accessing the private key if not specified in the signerInfo1 bean</em>

<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//Signer Information, by default the following signed attributes are included: contentType, signingTime, messageDigest, and cmsAlgorithmProtect; by default no unsigned attribute is included.</em>
<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// If you want to add your own signed attributes or unsigned attributes, see methods DefaultSignerInfo.setSignedAttributeGenerator and DefaultSignerInfo.setUnsignedAttributeGenerator.</em>
DefaultSignerInfo signerInfo1 = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> DefaultSignerInfo();
signerInfo1.setIncludeCertificates(true); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// if set to true then the certificate chain of the private key will be added to the Signed Data object</em>
signerInfo1.setSignatureAlgorithm(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"SHA256withRSA"</em></strong>); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// signature algorithm; attention, the signature algorithm must fit to the signer private key.</em>
signerInfo1.setPrivateKeyAlias(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"rsa"</em></strong>); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// alias of the private key used for the signing</em>
signerInfo1.setPassword(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"private_key_pw"</em></strong>.toCharArray()); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// optional parameter, if not set then the password of the KeyStoreParameters will be used for accessing the private key</em>
signerInfo1.setKeyStoreParameters(keystore);

DefaultSignerInfo signerInfo2 = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> DefaultSignerInfo();
signerInfo2.setIncludeCertificates(true);
signerInfo2.setSignatureAlgorithm(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"SHA256withDSA"</em></strong>);
signerInfo2.setPrivateKeyAlias(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"dsa"</em></strong>);
signerInfo2.setKeyStoreParameters(keystore);


simpleReg.put(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"keyStoreParameters"</em></strong>, keystore); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//register keystore in the registry</em>
simpleReg.put(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"signer1"</em></strong>, signerInfo1); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//register signer info in the registry</em>
simpleReg.put(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"signer2"</em></strong>, signerInfo2); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//register signer info in the registry</em>

from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:start"</em></strong>)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"crypto-cms:sign://testsign?signer=#signer1&amp;signer=#signer2&amp;includeContent=true"</em></strong>)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"crypto-cms:verify://testverify?keyStoreParameters=#keyStoreParameters"</em></strong>)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mock:result"</em></strong>);</pre><p><span class="strong"><strong>Example with two Signers in Spring XML</strong></span></p><pre class="programlisting">   <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;keyStoreParameters</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">xmlns</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://camel.apache.org/schema/spring"</span>
        <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"keyStoreParameters1"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">resource</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"./keystore/keystore.jceks"</span>
        <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">password</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"some_password"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">type</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"JCEKS"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;bean</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"signer1"</span>
        <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">class</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"org.apache.camel.component.crypto.cms.sig.DefaultSignerInfo"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"keyStoreParameters"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">ref</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"keyStoreParameters1"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"privateKeyAlias"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"rsa"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"signatureAlgorithm"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"SHA256withRSA"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"includeCertificates"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"true"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
        <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- optional parameter 'password', if not set then the password of the KeyStoreParameters will be used for accessing the private key --&gt;</em>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"password"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"private_key_pw"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/bean&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;bean</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"signer2"</span>
        <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">class</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"org.apache.camel.component.crypto.cms.sig.DefaultSignerInfo"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"keyStoreParameters"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">ref</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"keyStoreParameters1"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"privateKeyAlias"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"dsa"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"signatureAlgorithm"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"SHA256withDSA"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
        <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- optional parameter 'password', if not set then the password of the KeyStoreParameters will be used for accessing the private key --&gt;</em>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"password"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"private_key_pw2"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/bean&gt;</strong>
...
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;route&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;from</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"direct:start"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"crypto-cms:sign://testsign?signer=#signer1&amp;amp;signer=#signer2&amp;amp;includeContent=true"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"crypto-cms:verify://testverify?keyStoreParameters=#keyStoreParameters1"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"mock:result"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/route&gt;</strong></pre><p><span class="strong"><strong>Detached Signature Example in Java DSL</strong></span></p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> org.apache.camel.util.jsse.KeyStoreParameters;
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">import</strong> org.apache.camel.component.crypto.cms.sig.DefaultSignerInfo;
...
KeyStoreParameters keystore  = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> KeyStoreParameters();
keystore.setType(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"JCEKS"</em></strong>);
keystore.setResource(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"keystore/keystore.jceks);
</em></strong>keystore.setPassword(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"some_password"</em></strong>); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// this password will also be used for accessing the private key if not specified in the signerInfo1 bean</em>

<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//Signer Information, by default the following signed attributes are included: contentType, signingTime, messageDigest, and cmsAlgorithmProtect; by default no unsigned attribute is included.</em>
<em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// If you want to add your own signed attributes or unsigned attributes, see methods DefaultSignerInfo.setSignedAttributeGenerator and DefaultSignerInfo.setUnsignedAttributeGenerator.</em>
DefaultSignerInfo signerInfo1 = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> DefaultSignerInfo();
signerInfo1.setIncludeCertificates(true); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// if set to true then the certificate chain of the private key will be added to the Signed Data object</em>
signerInfo1.setSignatureAlgorithm(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"SHA256withRSA"</em></strong>); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// signature algorithm; attention, the signature algorithm must fit to the signer private key.</em>
signerInfo1.setPrivateKeyAlias(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"rsa"</em></strong>); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// alias of the private key used for the signing</em>
signerInfo1.setPassword(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"private_key_pw"</em></strong>.toCharArray()); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">// optional parameter, if not set then the password of the KeyStoreParameters will be used for accessing the private key</em>
signerInfo1.setKeyStoreParameters(keystore);

simpleReg.put(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"keyStoreParameters"</em></strong>, keystore); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//register keystore in the registry</em>
simpleReg.put(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"signer1"</em></strong>, signerInfo1); <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//register signer info in the registry</em>

from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:start"</em></strong>)
     <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//with the option includeContent=false the SignedData object without the signed text will be written into the header "CamelCryptoCmsSignedData"</em>
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"crypto-cms:sign://testsign?signer=#signer1&amp;includeContent=false&amp;toBase64=true"</em></strong>)
    <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">//the verifier reads the Signed Data object form the header CamelCryptoCmsSignedData and assumes that the signed content is in the message body</em>
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"crypto-cms:verify://testverify?keyStoreParameters=#keyStoreParameters&amp;signedDataHeaderBase64=true"</em></strong>)
    .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"mock:result"</em></strong>);</pre><p><span class="strong"><strong>Detached Signature Example in Spring XML</strong></span></p><pre class="programlisting">   <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;keyStoreParameters</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">xmlns</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://camel.apache.org/schema/spring"</span>
        <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"keyStoreParameters1"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">resource</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"./keystore/keystore.jceks"</span>
        <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">password</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"some_password"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">type</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"JCEKS"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;bean</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"signer1"</span>
        <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">class</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"org.apache.camel.component.crypto.cms.sig.DefaultSignerInfo"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"keyStoreParameters"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">ref</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"keyStoreParameters1"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"privateKeyAlias"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"rsa"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"signatureAlgorithm"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"SHA256withRSA"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"includeCertificates"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"true"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
        <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- optional parameter 'password', if not set then the password of the KeyStoreParameters will be used for accessing the private key --&gt;</em>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;property</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"password"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">value</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"private_key_pw"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/bean&gt;</strong>
...
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;route&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;from</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"direct:start"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
        <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- with the option includeContent=false the SignedData object without the signed text will be written into the header "CamelCryptoCmsSignedData" --&gt;</em>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"crypto-cms:sign://testsign?signer=#signer1&amp;amp;includeContent=false&amp;amp;toBase64=true"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
        <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- the verifier reads the Signed Data object form the header CamelCryptoCmsSignedData and assumes that the signed content is in the message body --&gt;</em>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"crypto-cms:verify://testverify?keyStoreParameters=#keyStoreParameters1&amp;amp;signedDataHeaderBase64=true"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"mock:result"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> /&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/route&gt;</strong></pre></div></div></body></html>