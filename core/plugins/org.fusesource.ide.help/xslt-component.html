<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>XSLT Component</title><link rel="stylesheet" type="text/css" href="eclipse_book.css"><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"><link rel="home" href="index.html" title="Red Hat Fuse Tooling for Eclipse"><link rel="up" href="IDU-Components.html" title="Part&nbsp;V.&nbsp;Apache Camel Component Reference"><link rel="prev" href="xquery-component.html" title="XQuery Component"><link rel="next" href="xstream-dataformat.html" title="XStream DataFormat"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="xslt-component"></a>XSLT Component</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="xslt-component.html#_uri_format_212">URI format</a></span></dt><dt><span class="section"><a href="xslt-component.html#_options_170">Options</a></span></dt><dt><span class="section"><a href="xslt-component.html#_using_xslt_endpoints">Using XSLT endpoints</a></span></dt><dt><span class="section"><a href="xslt-component.html#_getting_useable_parameters_into_the_xslt">Getting Useable Parameters into the XSLT</a></span></dt><dt><span class="section"><a href="xslt-component.html#_spring_xml_versions">Spring XML versions</a></span></dt><dt><span class="section"><a href="xslt-component.html#_using_xsl_include">Using xsl:include</a></span></dt><dt><span class="section"><a href="xslt-component.html#_using_xsl_include_and_default_prefix">Using xsl:include and default prefix</a></span></dt><dt><span class="section"><a href="xslt-component.html#_using_saxon_extension_functions">Using Saxon extension functions</a></span></dt><dt><span class="section"><a href="xslt-component.html#_dynamic_stylesheets">Dynamic stylesheets</a></span></dt><dt><span class="section"><a href="xslt-component.html#_accessing_warnings_errors_and_fatalerrors_from_xslt_errorlistener">Accessing warnings, errors and fatalErrors from XSLT ErrorListener</a></span></dt><dt><span class="section"><a href="xslt-component.html#_notes_on_using_xslt_and_java_versions">Notes on using XSLT and Java Versions</a></span></dt><dt><span class="section"><a href="xslt-component.html#_see_also_148">See Also</a></span></dt></dl></div><p><span class="strong"><strong>Available as of Camel version 1.3</strong></span></p><p>The <span class="strong"><strong>xslt:</strong></span> component allows you to process a message using an
<a class="link" href="http://www.w3.org/TR/xslt" target="_top">XSLT</a> template. This can be ideal when using
Templating to generate respopnses for requests.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_uri_format_212"></a>URI format</h2></div></div></div><pre class="screen">xslt:templateName[?options]</pre><p>The URI format contains <span class="strong"><strong>templateName</strong></span>, which can be one of the following:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">the classpath-local URI of the template to invoke</li><li class="listitem">the complete URL of the remote template.</li></ul></div><p>You can append query options to the URI in the following format:</p><p><span class="strong"><strong>?option=value&amp;option=value&amp;&#8230;&#8203;</strong></span></p><p>Refer to the <a class="link" href="http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/core/io/DefaultResourceLoader.html" target="_top">Spring
Documentation</a> for more detail of the URI syntax.</p><div class="table"><p class="title"><b>Table&nbsp;155.&nbsp;Example URIs</b></p><div class="table-contents"><table summary="Example URIs" border="1"><colgroup><col width="50%" class="col_1"><col width="50%" class="col_2"></colgroup><thead><tr><th align="left" valign="top">URI</th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p>xslt:com/acme/mytransform.xsl</p></td><td align="left" valign="top"><p>Refers to the file com/acme/mytransform.xsl on the classpath</p></td></tr><tr><td align="left" valign="top"><p>xslt:file:///foo/bar.xsl</p></td><td align="left" valign="top"><p>Refers to the file /foo/bar.xsl</p></td></tr><tr><td align="left" valign="top"><p>xslt:http://acme.com/cheese/foo.xsl</p></td><td align="left" valign="top"><p>Refers to the remote http resource</p></td></tr></tbody></table></div></div><br class="table-break"><p>For <span class="strong"><strong>Camel 2.8</strong></span> or older, Maven users will need to add the following dependency to their <code class="literal">pom.xml</code>
for this component:</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;dependency&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;groupId&gt;</strong>org.apache.camel<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/groupId&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;artifactId&gt;</strong>camel-spring<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/artifactId&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;version&gt;</strong>x.x.x<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/version&gt;</strong>
    <em xmlns="http://www.w3.org/1999/xhtml" class="hl-comment" style="color: silver">&lt;!-- use the same version as your Camel core version --&gt;</em>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/dependency&gt;</strong></pre><p>From <span class="strong"><strong>Camel 2.9</strong></span> onwards the <a class="link" href="xslt-component.html" title="XSLT Component">XSLT</a> component is provided
directly in the camel-core.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_options_170"></a>Options</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="xslt-component.html#_path_parameters_1_parameters_188">Path Parameters (1 parameters):</a></span></dt><dt><span class="section"><a href="xslt-component.html#_query_parameters_17_parameters_6">Query Parameters (17 parameters):</a></span></dt></dl></div><p>The XSLT component supports 9 options which are listed below.</p><div class="informaltable"><table border="1" width="100%"><colgroup><col width="19%" class="col_1"><col width="51%" class="col_2"><col width="10%" class="col_3"><col width="20%" class="col_4"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Description</th><th align="center" valign="top">Default</th><th align="left" valign="top">Type</th></tr></thead><tbody><tr><td align="left" valign="top"><p><span class="strong"><strong>xmlConverter</strong></span> (advanced)</p></td><td align="left" valign="top"><p>To use a custom implementation of org.apache.camel.converter.jaxp.XmlConverter</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>XmlConverter</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>uriResolverFactory</strong></span> (advanced)</p></td><td align="left" valign="top"><p>To use a custom UriResolver which depends on a dynamic endpoint resource URI. Should not be used together with the option 'uriResolver'.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>XsltUriResolverFactory</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>uriResolver</strong></span> (advanced)</p></td><td align="left" valign="top"><p>To use a custom UriResolver. Should not be used together with the option 'uriResolverFactory'.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>URIResolver</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>contentCache</strong></span> (producer)</p></td><td align="left" valign="top"><p>Cache for the resource content (the stylesheet file) when it is loaded. If set to false Camel will reload the stylesheet file on each message processing. This is good for development. A cached stylesheet can be forced to reload at runtime via JMX using the clearCachedStylesheet operation.</p></td><td align="center" valign="top"><p>true</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>saxon</strong></span> (producer)</p></td><td align="left" valign="top"><p>Whether to use Saxon as the transformerFactoryClass. If enabled then the class net.sf.saxon.TransformerFactoryImpl. You would need to add Saxon to the classpath.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>saxonExtensionFunctions</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Allows you to use a custom net.sf.saxon.lib.ExtensionFunctionDefinition. You would need to add camel-saxon to the classpath. The function is looked up in the registry, where you can comma to separate multiple values to lookup.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>saxonConfiguration</strong></span> (advanced)</p></td><td align="left" valign="top"><p>To use a custom Saxon configuration</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>Object</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>saxonConfiguration Properties</strong></span> (advanced)</p></td><td align="left" valign="top"><p>To set custom Saxon configuration properties</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>Map</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>resolveProperty Placeholders</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Whether the component should resolve property placeholders on itself when starting. Only properties which are of String type can use property placeholders.</p></td><td align="center" valign="top"><p>true</p></td><td align="left" valign="top"><p>boolean</p></td></tr></tbody></table></div><p>The XSLT endpoint is configured using URI syntax:</p><pre class="screen">xslt:resourceUri</pre><p>with the following path and query parameters:</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_path_parameters_1_parameters_188"></a>Path Parameters (1 parameters):</h3></div></div></div><div class="informaltable"><table border="1" width="100%"><colgroup><col width="19%" class="col_1"><col width="51%" class="col_2"><col width="10%" class="col_3"><col width="20%" class="col_4"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Description</th><th align="center" valign="top">Default</th><th align="left" valign="top">Type</th></tr></thead><tbody><tr><td align="left" valign="top"><p><span class="strong"><strong>resourceUri</strong></span></p></td><td align="left" valign="top"><p><span class="strong"><strong>Required</strong></span> Path to the template. The following is supported by the default URIResolver. You can prefix with: classpath, file, http, ref, or bean. classpath, file and http loads the resource using these protocols (classpath is default). ref will lookup the resource in the registry. bean will call a method on a bean to be used as the resource. For bean you can specify the method name after dot, eg bean:myBean.myMethod</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_query_parameters_17_parameters_6"></a>Query Parameters (17 parameters):</h3></div></div></div><div class="informaltable"><table border="1" width="100%"><colgroup><col width="19%" class="col_1"><col width="51%" class="col_2"><col width="10%" class="col_3"><col width="20%" class="col_4"></colgroup><thead><tr><th align="left" valign="top">Name</th><th align="left" valign="top">Description</th><th align="center" valign="top">Default</th><th align="left" valign="top">Type</th></tr></thead><tbody><tr><td align="left" valign="top"><p><span class="strong"><strong>allowStAX</strong></span> (producer)</p></td><td align="left" valign="top"><p>Whether to allow using StAX as the javax.xml.transform.Source.</p></td><td align="center" valign="top"><p>true</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>contentCache</strong></span> (producer)</p></td><td align="left" valign="top"><p>Cache for the resource content (the stylesheet file) when it is loaded. If set to false Camel will reload the stylesheet file on each message processing. This is good for development. A cached stylesheet can be forced to reload at runtime via JMX using the clearCachedStylesheet operation.</p></td><td align="center" valign="top"><p>true</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>deleteOutputFile</strong></span> (producer)</p></td><td align="left" valign="top"><p>If you have output=file then this option dictates whether or not the output file should be deleted when the Exchange is done processing. For example suppose the output file is a temporary file, then it can be a good idea to delete it after use.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>failOnNullBody</strong></span> (producer)</p></td><td align="left" valign="top"><p>Whether or not to throw an exception if the input body is null.</p></td><td align="center" valign="top"><p>true</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>output</strong></span> (producer)</p></td><td align="left" valign="top"><p>Option to specify which output type to use. Possible values are: string, bytes, DOM, file. The first three options are all in memory based, where as file is streamed directly to a java.io.File. For file you must specify the filename in the IN header with the key Exchange.XSLT_FILE_NAME which is also CamelXsltFileName. Also any paths leading to the filename must be created beforehand, otherwise an exception is thrown at runtime.</p></td><td align="center" valign="top"><p>string</p></td><td align="left" valign="top"><p>XsltOutput</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>saxon</strong></span> (producer)</p></td><td align="left" valign="top"><p>Whether to use Saxon as the transformerFactoryClass. If enabled then the class net.sf.saxon.TransformerFactoryImpl. You would need to add Saxon to the classpath.</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>transformerCacheSize</strong></span> (producer)</p></td><td align="left" valign="top"><p>The number of javax.xml.transform.Transformer object that are cached for reuse to avoid calls to Template.newTransformer().</p></td><td align="center" valign="top"><p>0</p></td><td align="left" valign="top"><p>int</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>converter</strong></span> (advanced)</p></td><td align="left" valign="top"><p>To use a custom implementation of org.apache.camel.converter.jaxp.XmlConverter</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>XmlConverter</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>entityResolver</strong></span> (advanced)</p></td><td align="left" valign="top"><p>To use a custom org.xml.sax.EntityResolver with javax.xml.transform.sax.SAXSource.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>EntityResolver</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>errorListener</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Allows to configure to use a custom javax.xml.transform.ErrorListener. Beware when doing this then the default error listener which captures any errors or fatal errors and store information on the Exchange as properties is not in use. So only use this option for special use-cases.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>ErrorListener</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>resultHandlerFactory</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Allows you to use a custom org.apache.camel.builder.xml.ResultHandlerFactory which is capable of using custom org.apache.camel.builder.xml.ResultHandler types.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>ResultHandlerFactory</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>saxonConfiguration</strong></span> (advanced)</p></td><td align="left" valign="top"><p>To use a custom Saxon configuration</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>Object</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>saxonExtensionFunctions</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Allows you to use a custom net.sf.saxon.lib.ExtensionFunctionDefinition. You would need to add camel-saxon to the classpath. The function is looked up in the registry, where you can comma to separate multiple values to lookup.</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>synchronous</strong></span> (advanced)</p></td><td align="left" valign="top"><p>Sets whether synchronous processing should be strictly used, or Camel is allowed to use asynchronous processing (if supported).</p></td><td align="center" valign="top"><p>false</p></td><td align="left" valign="top"><p>boolean</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>transformerFactory</strong></span> (advanced)</p></td><td align="left" valign="top"><p>To use a custom XSLT transformer factory</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>TransformerFactory</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>transformerFactoryClass</strong></span> (advanced)</p></td><td align="left" valign="top"><p>To use a custom XSLT transformer factory, specified as a FQN class name</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>String</p></td></tr><tr><td align="left" valign="top"><p><span class="strong"><strong>uriResolver</strong></span> (advanced)</p></td><td align="left" valign="top"><p>To use a custom javax.xml.transform.URIResolver</p></td><td align="center" valign="top">&nbsp;</td><td align="left" valign="top"><p>URIResolver</p></td></tr></tbody></table></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_using_xslt_endpoints"></a>Using XSLT endpoints</h2></div></div></div><p>The following format is an expample of using an XSLT template to formulate a response for a message for InOut
message exchanges (where there is a <code class="literal">JMSReplyTo</code> header)</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"activemq:My.Queue"</em></strong>).
  to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"xslt:com/acme/mytransform.xsl"</em></strong>);</pre><p>If you want to use InOnly and consume the message and send it to another
destination you could use the following route:</p><pre class="programlisting">from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"activemq:My.Queue"</em></strong>).
  to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"xslt:com/acme/mytransform.xsl"</em></strong>).
  to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"activemq:Another.Queue"</em></strong>);</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_getting_useable_parameters_into_the_xslt"></a>Getting Useable Parameters into the XSLT</h2></div></div></div><p>By default, all headers are added as parameters which are then available in
the XSLT.
To make the parameters useable, you will need to declare them.</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;setHeader</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">headerName</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"myParam"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;constant&gt;</strong>42<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/constant&gt;</strong><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/setHeader&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"xslt:MyTransform.xsl"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong></pre><p>The parameter also needs to be declared in the top level of the XSLT for it to be
available:</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;xsl:</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">......</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096"> &gt;</strong>

   <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;xsl:param</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">name</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"myParam"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>

    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;xsl:template</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">...&gt;</span></pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_spring_xml_versions"></a>Spring XML versions</h2></div></div></div><p>To use the above examples in Spring XML you would use something like the following code:</p><pre class="programlisting">  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;camelContext</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">xmlns</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://activemq.apache.org/camel/schema/spring"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;route&gt;</strong>
      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;from</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"activemq:My.Queue"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"xslt:org/apache/camel/spring/processor/example.xsl"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"activemq:Another.Queue"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/route&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/camelContext&gt;</strong></pre><p>To see an example, look at the
<a class="link" href="http://svn.apache.org/repos/asf/camel/trunk/components/camel-spring/src/test/java/org/apache/camel/spring/processor/XsltTest.java" target="_top">test
case</a> along with its
<a class="link" href="http://svn.apache.org/repos/asf/camel/trunk/components/camel-spring/src/test/resources/org/apache/camel/spring/processor/XsltTest-context.xml" target="_top">
Spring XML</a>.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_using_xsl_include"></a>Using xsl:include</h2></div></div></div><p><span class="strong"><strong>Camel 2.2 or older</strong></span>
If you use <code class="literal">xsl:include</code> in your XSL files in <span class="strong"><strong>Camel 2.2 or older</strong></span>, the default <code class="literal">javax.xml.transform.URIResolver</code> is used. Files will be resolved relative to the
JVM starting folder.</p><p>For example the following include statement will look up the <code class="literal">staff_template.xsl</code> file starting from the folder where the application was started.</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;xsl:include</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">href</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"staff_template.xsl"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong></pre><p><span class="strong"><strong>Camel 2.3 or newer</strong></span> 
 For Camel 2.3 or newer, Camel provides its own implementation of <code class="literal">URIResolver</code>. This allows
Camel to load included files from the classpath.</p><p>For example the include file in the following code will be located relative to the starting endpoint.</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;xsl:include</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">href</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"staff_template.xsl"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong></pre><p>This means that Camel will locate the file in the <span class="strong"><strong>classpath</strong></span> as
<span class="strong"><strong>org/apache/camel/component/xslt/staff_template.xsl</strong></span></p><p>You can use <code class="literal">classpath:</code> or <code class="literal">file:</code> to instruct Camel to look either in the classpath or file system. If you omit
the prefix then Camel uses the prefix from the endpoint configuration.
If no prefix is specified in the endpoint configuration, the default is <code class="literal">classpath:</code>.</p><p>You can also refer backwards in the include paths. In the following example, the xsl file will be resolved  under <code class="literal">org/apache/camel/component</code>.</p><pre class="programlisting">    &lt;xsl:include href=<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"../staff_other_template.xsl"</em></strong>/&gt;</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_using_xsl_include_and_default_prefix"></a>Using xsl:include and default prefix</h2></div></div></div><p>In <span class="strong"><strong>Camel 2.10.3 and older</strong></span>, <code class="literal">classpath:</code> is used as the default prefix.
If you configure the starting resource to load using <code class="literal">file:</code> then all subsequent incudes will have to be prefixed with <code class="literal">file:</code>.</p><p>From <span class="strong"><strong>Camel 2.10.4</strong></span>, Camel will use the prefix from the endpoint configuration as the default prefix.</p><p>You can explicitly specify <code class="literal">file:</code> or <code class="literal">classpath:</code> loading. The two loading types can be mixed in a XSLT script, if necessary.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_using_saxon_extension_functions"></a>Using Saxon extension functions</h2></div></div></div><p>Since Saxon 9.2, writing extension functions has been supplemented by a
new mechanism, referred to
as&nbsp;<a class="link" href="http://www.saxonica.com/html/documentation/extensibility/integratedfunctions" target="_top">integrated
extension functions</a>&nbsp;you can now easily use camel as shown in the below example:</p><pre class="programlisting">SimpleRegistry registry = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> SimpleRegistry();
registry.put(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"function1"</em></strong>, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> MyExtensionFunction1());
registry.put(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"function2"</em></strong>, <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> MyExtensionFunction2());

CamelContext context = <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> DefaultCamelContext(registry);
context.addRoutes(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">new</strong> RouteBuilder() {
    <em xmlns="http://www.w3.org/1999/xhtml"><span class="hl-annotation" style="color: gray">@Override</span></em>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">public</strong> <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">void</strong> configure() <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-keyword">throws</strong> Exception {
        from(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"direct:start"</em></strong>)
            .to(<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-string"><em style="color:red">"xslt:org/apache/camel/component/xslt/extensions/extensions.xslt?saxonExtensionFunctions=#function1,#function2"</em></strong>);
    }
});</pre><p>With Spring XML:</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;bean</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"function1"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">class</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"org.apache.camel.component.xslt.extensions.MyExtensionFunction1"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;bean</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">id</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"function2"</span> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">class</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"org.apache.camel.component.xslt.extensions.MyExtensionFunction2"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>

<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;camelContext</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">xmlns</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"http://camel.apache.org/schema/spring"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;route&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;from</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"direct:extensions"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;to</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">uri</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"xslt:org/apache/camel/component/xslt/extensions/extensions.xslt?saxonExtensionFunctions=#function1,#function2"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/route&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/camelContext&gt;</strong></pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_dynamic_stylesheets"></a>Dynamic stylesheets</h2></div></div></div><p>To provide a dynamic stylesheet at runtime you can define a dynamic URI.
See&nbsp;<a class="link" href="how-to-use-a-dynamic-uri-in-to.html" target="_top">How to use a dynamic URI in
to()</a> for more information.</p><p><span class="strong"><strong>Available as of Camel 2.9 (removed in 2.11.4, 2.12.3 and 2.13.0)</strong></span>
 Camel provides the <code class="literal">CamelXsltResourceUri</code> header which you can use to
define an alternative stylesheet to that configured on the endpoint
URI. This allows you to provide a dynamic stylesheet at runtime.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_accessing_warnings_errors_and_fatalerrors_from_xslt_errorlistener"></a>Accessing warnings, errors and fatalErrors from XSLT ErrorListener</h2></div></div></div><p><span class="strong"><strong>Available as of Camel 2.14</strong></span></p><p>From <span class="strong"><strong>Camel 2.14</strong></span>, any warning/error or fatalError is stored on
the current Exchange as a property with the
keys&nbsp;<code class="literal">Exchange.XSLT_ERROR</code>,&nbsp;<code class="literal">Exchange.XSLT_FATAL_ERROR</code>,
or&nbsp;<code class="literal">Exchange.XSLT_WARNING</code> which allows end users to get hold of any
errors happening during transformation.</p><p>For example in the stylesheet below, we want to terminate if a staff has
an empty dob field. And to include a custom error message using
xsl:message.</p><pre class="programlisting"><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;xsl:template</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">match</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"/"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;html&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;body&gt;</strong>
      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;xsl:for-each</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">select</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"staff/programmer"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;p&gt;</strong>Name: <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;xsl:value-of</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">select</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"name"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">/&gt;</strong><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;br /&gt;</strong>
          <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;xsl:if</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">test</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"dob=''"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>
            <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;xsl:message</strong> <span xmlns="http://www.w3.org/1999/xhtml" class="hl-attribute" style="color: #F5844C">terminate</span>=<span xmlns="http://www.w3.org/1999/xhtml" class="hl-value" style="color: #993300">"yes"</span><strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&gt;</strong>Error: DOB is an empty string!<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/xsl:message&gt;</strong>
          <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/xsl:if&gt;</strong>
        <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/p&gt;</strong>
      <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/xsl:for-each&gt;</strong>
    <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/body&gt;</strong>
  <strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/html&gt;</strong>
<strong xmlns="http://www.w3.org/1999/xhtml" class="hl-tag" style="color: #000096">&lt;/xsl:template&gt;</strong></pre><p>The exception is stored on the Exchange as a warning with the
key&nbsp;<code class="literal">Exchange.XSLT_WARNING.</code></p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_notes_on_using_xslt_and_java_versions"></a>Notes on using XSLT and Java Versions</h2></div></div></div><p>Here are some observations from Sameer, a Camel user, which he kindly
shared with us:</p><p>In case anybody faces issues with the XSLT endpoint please review these
points.</p><p>I was trying to use an xslt endpoint for a simple transformation from
one xml to another using a simple xsl. The output xml kept appearing
(after the xslt processor in the route) with outermost xml tag with no
content within.</p><p>No explanations show up in the DEBUG logs. On the TRACE logs however I
did find some error/warning indicating that the XMLConverter bean could
no be initialized.</p><p>After a few hours of cranking my mind, I had to do the following to get
it to work (thanks to some posts on the users forum that gave some
clue):</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">Use the transformerFactory option in the route
<code class="literal">("xslt:my-transformer.xsl?transformerFactory=tFactory")</code> with the
<code class="literal">tFactory</code> bean having bean defined in the spring context for
<code class="literal">class="org.apache.xalan.xsltc.trax.TransformerFactoryImpl"</code>.</li><li class="listitem">Added the Xalan jar into my maven pom.</li></ol></div><p>My guess is that the default xml parsing mechanism supplied within the
JDK (I am using 1.6.0_03) does not work right in this context and does
not throw up any error either. When I switched to Xalan this way it
works. This is not a Camel issue, but might need a mention on the xslt
component page.</p><p>Another note, jdk 1.6.0_03 ships with JAXB 2.0 while Camel needs 2.1.
One workaround is to add the 2.1 jar to the <code class="literal">jre/lib/endorsed</code> directory
for the jvm or as specified by the container.</p><p>Hope this post saves newbie Camel riders some time.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_see_also_148"></a>See Also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Configuring Camel</li><li class="listitem">Component</li><li class="listitem">Endpoint</li><li class="listitem">Getting Started</li></ul></div></div></div></body></html>